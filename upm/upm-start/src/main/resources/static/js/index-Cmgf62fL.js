var M=Object.defineProperty,R=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var v=(i,e,t)=>e in i?M(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,p=(i,e)=>{for(var t in e||(e={}))A.call(e,t)&&v(i,t,e[t]);if(_)for(var t of _(e))$.call(e,t)&&v(i,t,e[t]);return i},x=(i,e)=>R(i,V(e));var P=(i,e,t)=>new Promise((h,c)=>{var g=r=>{try{n(t.next(r))}catch(d){c(d)}},w=r=>{try{n(t.throw(r))}catch(d){c(d)}},n=r=>r.done?h(r.value):Promise.resolve(r.value).then(g,w);n((t=t.apply(i,e)).next())});import{W as Y}from"./index-C4NAiFfA.js";import{dI as j,dJ as q,dz as G,a7 as I}from"./bootstrap-DjYyHEgg.js";import{h as H}from"./fileTransfer-p8-3apt7.js";import{i as J}from"./table-FRaKquww.js";import{u as W,_ as U}from"./useTableImport-CNd8lRg2.js";import{u as K}from"./useDownLoad-Cw45s4VH.js";import{u as Q}from"./useShopCheck-DKIjDUfz.js";import{ci as k,m as X,b9 as Z,aa as ee,be as te,ab as f,b2 as m,bJ as l,j as b,u as o,bL as T,ai as N,ad as oe,I as ie,bb as re,bp as se}from"../jse/index-index-rmdNY63r.js";import{p as ae}from"./contast-C3bEivmW.js";import{u as le}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as ne}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as de}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:pe}=le(),S={toolbarConfig:{resizable:!0,search:!1},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"type",title:"类型",width:150},{field:"billingPeriod",title:"账期",width:150},{field:"fundDirection",title:"资金方向",width:150},{field:"billCategory",title:"账单大类",width:150},{field:"businessCategory",title:"业务大类",width:150},{field:"businessSubcategory",title:"业务小类",width:150},{field:"transactionTime",title:"时间",width:150},{field:"orderNo",title:"订单号",width:190},{field:"pointsServiceFee",title:"积分类服务费金额",width:150},{field:"alipayOrderNo",title:"支付宝订单号",width:220},{field:"remark",title:"备注",width:200},{field:"mainOrderNo",title:"交易主订单号",width:220},{field:"subOrderNo",title:"交易子订单号",width:220},{field:"productId",title:"商品ID",width:220},{field:"productName",title:"商品名称",width:360},{field:"quantity",title:"数量",width:150},{field:"discountAmount",title:"优惠总金额",width:150},{field:"platformRatio",title:"平台出资比例",width:150},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:i}){const e=ae.find(t=>t.value===i);return e?e.label:i}},{field:"createTime",title:"创建时间",width:160}]},me={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"billingPeriod",label:"账期"},pe.datetime("transactionTime","时间",[k().startOf("month"),k().endOf("month")]),{component:"Select",componentProps:{allowClear:!0,options:[{label:"天猫-淘金币",value:"淘金币"},{label:"消费积分",value:"消费积分"},{label:"芭芭农场",value:"芭芭农场"}],placeholder:"请选择"},fieldName:"type",label:"类型"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"orderNo",label:"订单号"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"alipayOrderNo",label:"支付宝订单号"}],fieldMappingTime:[["transactionTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Ee=X({__name:"index",setup(i){const{checkShopSelected:e}=Q(),{bizImportType:t,extension:h,bizImportTypeList:c,uploadFormRef:g,handleImport:w,ImportSettingButton:n}=W({importTypeList:[{id:1,label:"天猫-淘金币导入数据",bizCode:"TM_COINS",isError:!1,auth:"basic:consumptionPoints:tmallImport"},{id:2,label:"消费积分导入数据",bizCode:"TM_POINTS",isError:!1,auth:"basic:consumptionPoints:consumeImport"},{id:3,label:"芭芭农场导入数据",bizCode:"TM_FARM",isError:!1,auth:"basic:consumptionPoints:farmImport"}],defaultExtension:".xlsx,.csv"}),r=Z(j.tmallConsumptionPointsCsv),d=p({},me),z=x(p({},S),{toolbarConfig:p({},S.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(a,ce)=>P(null,[a,ce],function*({page:{currentPage:y,pageSize:s}},u){return e()?yield J(p({current:y,size:s},u)):{result:{records:[],total:0}}})}}}),O={},[D,C]=q({gridEvents:O,formOptions:d,gridOptions:z}),{handleDownload:E,downLoading:L}=K(),{hasAccessByCodes:B}=G(),F=ee(()=>B(["basic:consumptionPoints:list"]));return(y,s)=>{const u=te("access");return F.value?(m(),f(o(ne),{key:0,"auto-content-height":""},{default:l(()=>[b(o(D),null,{"toolbar-actions":l(()=>[(m(!0),oe(ie,null,re(o(c),a=>T((m(),f(o(I),{key:a.id,type:"primary",style:{"margin-right":"12px"},onClick:ce=>o(w)(a.bizCode,a.isError,o(C))},{default:l(()=>[N(se(a.label),1)]),_:2},1032,["onClick"])),[[u,[a.auth],"codes"]])),128))]),"toolbar-tools":l(()=>[T((m(),f(o(I),{loading:o(L),class:"mr-2",type:"primary",onClick:s[0]||(s[0]=a=>o(E)(o(C),r.value))},{icon:l(()=>[b(o(Y),{class:"mr-1 inline-block size-6"})]),default:l(()=>[s[1]||(s[1]=N(" 导出数据 ",-1))]),_:1},8,["loading"])),[[u,["basic:consumptionPoints:export"],"codes"]]),b(o(n))]),_:1}),b(o(U),{ref_key:"uploadFormRef",ref:g,"biz-import-type":o(t),"upload-fn":o(H),extension:o(h)},null,8,["biz-import-type","upload-fn","extension"])]),_:1})):(m(),f(o(de),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Ee as default};
