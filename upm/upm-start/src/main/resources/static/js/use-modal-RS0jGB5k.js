var Qe=Object.defineProperty,Ze=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var de=(o,t,s)=>t in o?Qe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,f=(o,t)=>{for(var s in t||(t={}))xe.call(t,s)&&de(o,s,t[s]);if(le)for(var s of le(t))we.call(t,s)&&de(o,s,t[s]);return o},V=(o,t)=>Ze(o,et(t));var K=(o,t)=>{var s={};for(var a in o)xe.call(o,a)&&t.indexOf(a)<0&&(s[a]=o[a]);if(o!=null&&le)for(var a of le(o))t.indexOf(a)<0&&we.call(o,a)&&(s[a]=o[a]);return s};var W=(o,t,s)=>de(o,typeof t!="symbol"?t+"":t,s);var J=(o,t,s)=>new Promise((a,l)=>{var i=m=>{try{b(s.next(m))}catch(d){l(d)}},u=m=>{try{b(s.throw(m))}catch(d){l(d)}},b=m=>m.done?a(m.value):Promise.resolve(m.value).then(i,u);b((s=s.apply(o,t)).next())});import{m as A,ab as h,b2 as p,u as e,aS as tt,aw as ot,bJ as y,bc as g,aE as $e,ad as ue,aa as S,b9 as _,a2 as st,j as X,ac as B,aT as at,aR as R,cc as $,aQ as pe,b7 as Ae,v as nt,bF as lt,aW as rt,cJ as ce,by as it,w as dt,aX as ct,ae as ut,ai as G,bp as Q,bf as Be,n as fe,b4 as Te,cl as pt,L as ke}from"../jse/index-index-StHjciy-.js";import{bG as Ee,be as Se,bU as ft,ar as mt,bi as Le,c3 as ht,cl as yt,cg as vt,cm as gt,cb as bt,cn as Ct,co as xt,cp as wt,a_ as Bt,b2 as Oe,cq as kt,bM as Ot,cr as Dt}from"./bootstrap-B0IOIL79.js";import{D as Mt,a as _t,X as $t,b as At,c as Tt,d as Et}from"./x-eg9hdiEc.js";const St=Ee("expand",[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]]);const Lt=Ee("shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]),Pt=A({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=Se(o,t);return(i,u)=>(p(),h(e(Mt),tt(ot(e(l))),{default:y(()=>[g(i.$slots,"default")]),_:3},16))}}),It=["data-dismissable-modal"],zt=A({__name:"DialogOverlay",setup(o){ft();const t=$e("DISMISSABLE_MODAL_ID");return(s,a)=>(p(),ue("div",{"data-dismissable-modal":e(t),class:"z-popup inset-0 bg-overlay"},null,8,It))}}),Ft=A({__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},appendTo:{default:"body"},class:{},closeClass:{},closeDisabled:{type:Boolean,default:!1},modal:{type:Boolean},open:{type:Boolean},overlayBlur:{},showClose:{type:Boolean,default:!0},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(o,{expose:t,emit:s}){const a=o,l=s,i=S(()=>{const O=a,{class:r,modal:c,open:x,showClose:w}=O;return K(O,["class","modal","open","showClose"])});function u(){return a.appendTo==="body"||a.appendTo===document.body||!a.appendTo}const b=S(()=>u()?"fixed":"absolute"),m=Se(i,l),d=_(null);function v(r){var c;r.target===((c=d.value)==null?void 0:c.$el)&&(a.open?l("opened"):l("closed"))}return t({getContentRef:()=>d.value}),(r,c)=>(p(),h(st,{defer:"",to:o.appendTo},[X(mt,{name:"fade"},{default:y(()=>[o.open&&o.modal?(p(),h(zt,{key:0,style:at(V(f({},o.zIndex?{zIndex:o.zIndex}:{}),{position:b.value,backdropFilter:o.overlayBlur&&o.overlayBlur>0?`blur(${o.overlayBlur}px)`:"none"})),onClick:c[0]||(c[0]=()=>l("close"))},null,8,["style"])):B("",!0)]),_:1}),X(e(At),pe({ref_key:"contentRef",ref:d,style:V(f({},o.zIndex?{zIndex:o.zIndex}:{}),{position:b.value}),onAnimationend:v},e(m),{class:e($)("z-popup w-full bg-background p-6 shadow-lg outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-top-[48%] sm:rounded-xl",a.class)}),{default:y(()=>[g(r.$slots,"default"),o.showClose?(p(),h(e(_t),{key:0,disabled:o.closeDisabled,class:R(e($)("flex-center absolute right-3 top-3 h-6 w-6 rounded-full px-1 text-lg text-foreground/80 opacity-70 transition-opacity hover:bg-accent hover:text-accent-foreground hover:opacity-100 focus:outline-none disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",a.closeClass)),onClick:c[1]||(c[1]=()=>l("close"))},{default:y(()=>[X(e($t),{class:"h-4 w-4"})]),_:1},8,["disabled","class"])):B("",!0)]),_:3},16,["style","class"])],8,["to"]))}}),De=A({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=S(()=>{const u=t,{class:l}=u;return K(u,["class"])}),a=Le(s);return(l,i)=>(p(),h(e(Tt),pe(e(a),{class:e($)("text-sm text-muted-foreground",t.class)}),{default:y(()=>[g(l.$slots,"default")]),_:3},16,["class"]))}}),Vt=A({__name:"DialogFooter",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),ue("div",{class:R(e($)("flex flex-row flex-col-reverse justify-end gap-x-2",t.class))},[g(s.$slots,"default")],2))}}),Rt=A({__name:"DialogHeader",props:{class:{}},setup(o){const t=o;return(s,a)=>(p(),ue("div",{class:R(e($)("flex flex-col gap-y-1.5 text-center sm:text-left",t.class))},[g(s.$slots,"default")],2))}}),Me=A({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=S(()=>{const u=t,{class:l}=u;return K(u,["class"])}),a=Le(s);return(l,i)=>(p(),h(e(Et),pe(e(a),{class:e($)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:y(()=>[g(l.$slots,"default")]),_:3},16,["class"]))}});function Nt(o,t,s,a,l){const i=Ae({offsetX:0,offsetY:0}),u=_(!1),b=r=>{const c=r.clientX,x=r.clientY;if(!o.value)return;const w=o.value.getBoundingClientRect(),{offsetX:k,offsetY:O}=i,N=w.left,z=w.top,Z=w.width,ee=w.height;let L=null;if(a!=null&&a.value){const M=document.querySelector(a.value);M&&(L=M.getBoundingClientRect())}let Y,q,P,H;if(L)P=L.left-N+k,Y=L.right-N-Z+k,H=L.top-z+O,q=L.bottom-z-ee+O;else{const M=document.documentElement,D=M.clientWidth,T=M.clientHeight;P=-N+k,H=-z+O,Y=D-N-Z+k,q=T-z-ee+O}const te=M=>{let D=k+M.clientX-c,T=O+M.clientY-x;if(D=Math.min(Math.max(D,P),Y),T=Math.min(Math.max(T,H),q),i.offsetX=D,i.offsetY=T,o.value){const se=l==null?void 0:l.value;o.value.style.transform=se?`translate(${D}px, calc(-50% + ${T}px))`:`translate(${D}px, ${T}px)`,u.value=!0}},oe=()=>{u.value=!1,document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",oe)};document.addEventListener("mousemove",te),document.addEventListener("mouseup",oe)},m=()=>{const r=ce(t);r&&o.value&&r.addEventListener("mousedown",b)},d=()=>{const r=ce(t);r&&o.value&&r.removeEventListener("mousedown",b)},v=()=>{i.offsetX=0,i.offsetY=0;const r=ce(o);r&&(r.style.transform="")};return nt(()=>{lt(()=>{s.value?m():d()})}),rt(()=>{d()}),{dragging:u,resetPosition:v,transform:i}}const Xt=A({__name:"modal",props:{modalApi:{default:void 0},appendToMain:{type:Boolean,default:!1},bordered:{type:Boolean},cancelText:{},centered:{type:Boolean},class:{},closable:{type:Boolean},closeOnClickModal:{type:Boolean},closeOnPressEscape:{type:Boolean},confirmDisabled:{type:Boolean},confirmLoading:{type:Boolean},confirmText:{},contentClass:{},description:{},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean},footer:{type:Boolean},footerClass:{},fullscreen:{type:Boolean},fullscreenButton:{type:Boolean},header:{type:Boolean},headerClass:{},loading:{type:Boolean},modal:{type:Boolean},openAutoFocus:{type:Boolean},overlayBlur:{},showCancelButton:{type:Boolean},showConfirmButton:{type:Boolean},submitting:{type:Boolean},title:{},titleTooltip:{},zIndex:{}},setup(o){var ne,Ce;const t=o,s=ht.getComponents(),a=_(),l=_(),i=_(),u=_(),b=_(),m=it();Te("DISMISSABLE_MODAL_ID",m);const{$t:d}=yt(),{isMobile:v}=vt(),r=(Ce=(ne=t.modalApi)==null?void 0:ne.useStore)==null?void 0:Ce.call(ne),{appendToMain:c,bordered:x,cancelText:w,centered:k,class:O,closable:N,closeOnClickModal:z,closeOnPressEscape:Z,confirmDisabled:ee,confirmLoading:L,confirmText:Y,contentClass:q,description:P,destroyOnClose:H,draggable:te,footer:oe,footerClass:M,fullscreen:D,fullscreenButton:T,header:se,headerClass:Pe,loading:me,modal:Ie,openAutoFocus:ze,overlayBlur:Fe,showCancelButton:Ve,showConfirmButton:Re,submitting:E,title:ae,titleTooltip:he,zIndex:Ne}=gt(t,r),j=S(()=>D.value||v.value),ye=S(()=>te.value&&!j.value&&se.value),ve=S(()=>k.value&&!j.value),ge=S(()=>c.value?`#${bt}>div:not(.absolute)>div`:void 0),{dragging:Xe,transform:Ye}=Nt(i,u,ye,ge,ve),re=_(!1),ie=_(!0);dt(()=>{var n;return(n=r==null?void 0:r.value)==null?void 0:n.isOpen},n=>J(null,null,function*(){if(n){if(ie.value=!1,re.value||(re.value=!0),yield fe(),!a.value)return;const C=a.value.getContentRef();i.value=C.$el;const{offsetX:F,offsetY:I}=Ye;i.value.style.transform=ve.value?`translate(${F}px, calc(-50% + ${I}px))`:`translate(${F}px, ${I}px)`}}),{immediate:!0}),ct(()=>{var n;c.value||(n=t.modalApi)==null||n.close()});function qe(){var n;(n=t.modalApi)==null||n.setState(C=>V(f({},C),{fullscreen:!D.value}))}function He(n){(!z.value||E.value)&&(n.preventDefault(),n.stopPropagation())}function je(n){(!Z.value||E.value)&&n.preventDefault()}function Ue(n){ze.value||n==null||n.preventDefault()}function Ke(n){const C=n.target,F=C==null?void 0:C.dataset.dismissableModal;(!z.value||F!==m||E.value)&&(n.preventDefault(),n.stopPropagation())}function be(n){n.preventDefault(),n.stopPropagation()}const We=S(()=>!e(H)&&e(re)),Je=()=>{requestAnimationFrame(()=>{var n;(n=t.modalApi)==null||n.onOpened()})};function Ge(){var n;ie.value=!0,(n=t.modalApi)==null||n.onClosed()}return(n,C)=>{var F;return p(),h(e(Pt),{modal:!1,open:(F=e(r))==null?void 0:F.isOpen,"onUpdate:open":C[2]||(C[2]=()=>{var I;return e(E)||(I=o.modalApi)==null?void 0:I.close()})},{default:y(()=>{var I;return[X(e(Ft),{ref_key:"contentRef",ref:a,"append-to":ge.value,class:R(e($)("left-0 right-0 top-[10vh] mx-auto flex max-h-[80%] w-[520px] flex-col p-0",j.value?"sm:rounded-none":"sm:rounded-[var(--radius)]",e(O),{"border border-border":e(x),"shadow-3xl":!e(x),"left-0 top-0 size-full max-h-full !translate-x-0 !translate-y-0":j.value,"top-1/2":e(k)&&!j.value,"duration-300":!e(Xe),hidden:ie.value})),"force-mount":We.value,modal:e(Ie),open:(I=e(r))==null?void 0:I.isOpen,"show-close":e(N),"z-index":e(Ne),"overlay-blur":e(Fe),"close-class":"top-3",onCloseAutoFocus:be,onClosed:Ge,"close-disabled":e(E),onEscapeKeyDown:je,onFocusOutside:be,onInteractOutside:He,onOpenAutoFocus:Ue,onOpened:Je,onPointerDownOutside:Ke},{default:y(()=>[X(e(Rt),{ref_key:"headerRef",ref:u,class:R(e($)("px-5 py-4",{"border-b":e(x),hidden:!e(se),"cursor-move select-none":ye.value},e(Pe)))},{default:y(()=>[e(ae)?(p(),h(e(Me),{key:0,class:"text-left"},{default:y(()=>[g(n.$slots,"title",{},()=>[G(Q(e(ae))+" ",1),e(he)?g(n.$slots,"titleTooltip",{key:0},()=>[X(e(Ct),{"trigger-class":"pb-1"},{default:y(()=>[G(Q(e(he)),1)]),_:1})]):B("",!0)])]),_:3})):B("",!0),e(P)?(p(),h(e(De),{key:1},{default:y(()=>[g(n.$slots,"description",{},()=>[G(Q(e(P)),1)])]),_:3})):B("",!0),!e(ae)||!e(P)?(p(),h(e(xt),{key:2},{default:y(()=>[e(ae)?B("",!0):(p(),h(e(Me),{key:0})),e(P)?B("",!0):(p(),h(e(De),{key:1}))]),_:1})):B("",!0)]),_:3},8,["class"]),ut("div",{ref_key:"wrapperRef",ref:l,class:R(e($)("relative min-h-40 flex-1 overflow-y-auto p-3",e(q),{"pointer-events-none":e(me)||e(E)}))},[g(n.$slots,"default")],2),e(me)||e(E)?(p(),h(e(wt),{key:0,spinning:""})):B("",!0),e(T)?(p(),h(e(Bt),{key:1,class:"flex-center absolute right-10 top-3 hidden size-6 rounded-full px-1 text-lg text-foreground/80 opacity-70 transition-opacity hover:bg-accent hover:text-accent-foreground hover:opacity-100 focus:outline-none disabled:pointer-events-none sm:block",onClick:qe},{default:y(()=>[e(D)?(p(),h(e(Lt),{key:0,class:"size-3.5"})):(p(),h(e(St),{key:1,class:"size-3.5"}))]),_:1})):B("",!0),e(oe)?(p(),h(e(Vt),{key:2,ref_key:"footerRef",ref:b,class:R(e($)("flex-row items-center justify-end p-2",{"border-t":e(x)},e(M)))},{default:y(()=>[g(n.$slots,"prepend-footer"),g(n.$slots,"footer",{},()=>[e(Ve)?(p(),h(Be(e(s).DefaultButton||e(Oe)),{key:0,variant:"ghost",disabled:e(E),onClick:C[0]||(C[0]=()=>{var U;return(U=o.modalApi)==null?void 0:U.onCancel()})},{default:y(()=>[g(n.$slots,"cancelText",{},()=>[G(Q(e(w)||e(d)("cancel")),1)])]),_:3},8,["disabled"])):B("",!0),g(n.$slots,"center-footer"),e(Re)?(p(),h(Be(e(s).PrimaryButton||e(Oe)),{key:1,disabled:e(ee),loading:e(L)||e(E),onClick:C[1]||(C[1]=()=>{var U;return(U=o.modalApi)==null?void 0:U.onConfirm()})},{default:y(()=>[g(n.$slots,"confirmText",{},()=>[G(Q(e(Y)||e(d)("confirm")),1)])]),_:3},8,["disabled","loading"])):B("",!0)]),g(n.$slots,"append-footer")]),_:3},8,["class"])):B("",!0)]),_:3},8,["append-to","class","force-mount","modal","open","show-close","z-index","overlay-blur","close-disabled"])]}),_:3},8,["open"])}}});class Yt{constructor(t={}){W(this,"sharedData",{payload:{}});W(this,"store");W(this,"api");W(this,"state");const r=t,{connectedComponent:s,onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:u,onOpenChange:b,onOpened:m}=r,d=K(r,["connectedComponent","onBeforeClose","onCancel","onClosed","onConfirm","onOpenChange","onOpened"]),v={bordered:!0,centered:!1,class:"",closeOnClickModal:!0,closeOnPressEscape:!0,confirmDisabled:!1,confirmLoading:!1,contentClass:"",destroyOnClose:!0,draggable:!1,footer:!0,footerClass:"",fullscreen:!1,fullscreenButton:!0,header:!0,headerClass:"",isOpen:!1,loading:!1,modal:!0,openAutoFocus:!1,showCancelButton:!0,showConfirmButton:!0,title:""};this.store=new kt(f(f({},v),d),{onUpdate:()=>{var x,w,k;const c=this.store.state;(c==null?void 0:c.isOpen)===((x=this.state)==null?void 0:x.isOpen)?this.state=c:(this.state=c,(k=(w=this.api).onOpenChange)==null||k.call(w,!!(c!=null&&c.isOpen)))}}),this.state=this.store.state,this.api={onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:u,onOpenChange:b,onOpened:m},pt(this)}close(){return J(this,null,function*(){var s,a,l;((l=yield(a=(s=this.api).onBeforeClose)==null?void 0:a.call(s))!=null?l:!0)&&this.store.setState(i=>V(f({},i),{isOpen:!1}))})}getData(){var t,s;return(s=(t=this.sharedData)==null?void 0:t.payload)!=null?s:{}}lock(t=!0){return this.setState({submitting:t})}onCancel(){var t,s;this.api.onCancel?(s=(t=this.api).onCancel)==null||s.call(t):this.close()}onClosed(){var t,s;this.state.isOpen||(s=(t=this.api).onClosed)==null||s.call(t)}onConfirm(){var t,s;(s=(t=this.api).onConfirm)==null||s.call(t)}onOpened(){var t,s;this.state.isOpen&&((s=(t=this.api).onOpened)==null||s.call(t))}open(){this.store.setState(t=>V(f({},t),{isOpen:!0,submitting:!1}))}setData(t){return this.sharedData.payload=t,this}setState(t){return Ot(t)?this.store.setState(t):this.store.setState(s=>f(f({},s),t)),this}unlock(){return this.lock(!1)}}const _e=Symbol("VBEN_MODAL_INJECT"),qt={};function Jt(o={}){var m;const{connectedComponent:t}=o;if(t){const d=Ae({}),v=_(!0);return[A((c,{attrs:x,slots:w})=>(Te(_e,{extendApi(O){Object.setPrototypeOf(d,O)},options:o,reCreateModal(){return J(this,null,function*(){v.value=!1,yield fe(),v.value=!0})}}),Ht(d,f(f(f({},c),x),w)),()=>ke(v.value?t:"div",f(f({},c),x),w)),{name:"VbenParentModal",inheritAttrs:!1}),d]}const s=$e(_e,{}),a=f(f(f({},qt),s.options),o);a.onOpenChange=d=>{var v,r,c;(v=o.onOpenChange)==null||v.call(o,d),(c=(r=s.options)==null?void 0:r.onOpenChange)==null||c.call(r,d)};const l=a.onClosed;a.onClosed=()=>{var d;l==null||l(),a.destroyOnClose&&((d=s.reCreateModal)==null||d.call(s))};const i=new Yt(a),u=i;u.useStore=d=>Dt(i.store,d);const b=A((d,{attrs:v,slots:r})=>()=>ke(Xt,V(f(f({},d),v),{modalApi:u}),r),{name:"VbenModal",inheritAttrs:!1});return(m=s.extendApi)==null||m.call(s,u),[b,u]}function Ht(o,t){return J(this,null,function*(){var l;if(!t||Object.keys(t).length===0)return;yield fe();const s=(l=o==null?void 0:o.store)==null?void 0:l.state;if(!s)return;const a=new Set(Object.keys(s));for(const i of Object.keys(t))a.has(i)&&!["class"].includes(i)&&console.warn(`[Vben Modal]: When 'connectedComponent' exists, do not set props or slots '${i}', which will increase complexity. If you need to modify the props of Modal, please use useVbenModal or api.`)})}export{Jt as u};
