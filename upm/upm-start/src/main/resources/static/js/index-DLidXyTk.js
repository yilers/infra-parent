var D=Object.defineProperty,E=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var z=(s,e,t)=>e in s?D(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,d=(s,e)=>{for(var t in e||(e={}))R.call(e,t)&&z(s,t,e[t]);if(y)for(var t of y(e))j.call(e,t)&&z(s,t,e[t]);return s},h=(s,e)=>E(s,L(e));var _=(s,e,t)=>new Promise((v,f)=>{var k=i=>{try{u(t.next(i))}catch(c){f(c)}},C=i=>{try{u(t.throw(i))}catch(c){f(c)}},u=i=>i.done?v(i.value):Promise.resolve(i.value).then(k,C);u((t=t.apply(s,e)).next())});import{dJ as A,dz as M,dK as N,a7 as P}from"./bootstrap-DjYyHEgg.js";import{j as I}from"./fileTransfer-p8-3apt7.js";import{j as G}from"./table-FRaKquww.js";import{a as H}from"./dateTime-Ce6Ez397.js";import J from"./form-BPP3zHGO.js";import{B as O}from"./index-ClU3eF4t.js";import{_ as $}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{m as q,b9 as B,aa as K,v as Q,bd as U,be as W,ab as w,b2 as b,bJ as l,j as x,u as n,bL as X,ad as Y,ai as S,ae as Z,bp as g}from"../jse/index-index-rmdNY63r.js";const tt={1:"processing",2:"success",3:"error",0:"default"},et={0:"待处理",1:"处理中",2:"处理完成",3:"处理失败"},st={null:"未撤销",1:"撤销中",2:"撤销成功"},ot=s=>{const e=s===null?"null":s.toString();return st[e]||"未知状态"},V={toolbarConfig:{resizable:!0},columns:[{title:"导入时间",field:"createTime",width:190},{title:"导入日期",field:"timeStart",slots:{default:"timeStart"},width:180},{title:"耗时时间",field:"consumingTime",width:190},{title:"任务名称",field:"taskName",width:380},{field:"bizValue",title:"数据来源",slots:{default:"bizValue"},width:380},{field:"fileExtension",title:"文件类型",width:150},{field:"status",title:"任务状态",slots:{default:"status"},width:190},{field:"revokeStatus",title:"撤销状态",slots:{default:"revokeStatus"},width:190},{field:"totalCount",title:"总记录数",width:150},{field:"successCount",title:"成功记录数",width:150},{field:"failCount",title:"失败记录数",width:150},{field:"errorReason",title:"错误原因",width:300},{field:"errorDetails",title:"错误详情",width:450},{field:"action",slots:{default:"action"},title:"操作",width:120}]},it={key:1},pt=q({__name:"index",setup(s){const e=h(d({},V),{toolbarConfig:d({},V.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:F=>_(null,[F],function*({page:{currentPage:a,pageSize:m}}){const p=yield I({current:a,size:m}),o=p.records.map(r=>h(d({},r),{consumingTime:H(r.startTime,r.endTime)}));return h(d({},p),{records:o})})}}}),t=B(),v=a=>{t.value.setData({record:a,gridApi:k}),t.value.open()},[f,k]=A({gridOptions:e}),{hasAccessByCodes:C}=M(),u=K(()=>C(["basic:importFile:list"]));Q(()=>{c()});const i=B([]),c=()=>_(null,null,function*(){try{i.value=[];const a=yield G({});i.value=a}catch(a){N.error("获取业务编码失败")}});return(a,m)=>{const F=U("Fallback"),p=W("access");return u.value?(b(),w(n($),{key:0,"auto-content-height":""},{default:l(()=>[x(n(f),{"table-title":"导入数据文件"},{timeStart:l(({row:o})=>[S(g(o.timeStart)+" - "+g(o.timeEnd),1)]),status:l(({row:o})=>[x(n(O),{status:n(tt)[o.status],text:n(et)[o.status],class:"badge-3-words"},null,8,["status","text"])]),revokeStatus:l(({row:o})=>[S(g(n(ot)(o.revokeStatus)),1)]),bizValue:l(({row:o})=>{var r;return[Z("div",null,g(((r=i.value.find(T=>T.value===o.bizValue))==null?void 0:r.label)||o.bizValue),1)]}),action:l(({row:o})=>[o.revokeStatus===null?X((b(),w(n(P),{key:0,type:"link",onClick:r=>v(o)},{default:l(()=>[...m[0]||(m[0]=[S(" 撤销 ",-1)])]),_:1},8,["onClick"])),[[p,["basic:importFile:revoke"],"codes"]]):(b(),Y("span",it,"--"))]),_:1}),x(J,{ref_key:"customConfigurationProductFormRef",ref:t},null,512)]),_:1})):(b(),w(F,{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{pt as default};
