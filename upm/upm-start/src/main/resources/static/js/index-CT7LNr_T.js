var B=Object.defineProperty,V=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var S=(r,t,o)=>t in r?B(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o,m=(r,t)=>{for(var o in t||(t={}))J.call(t,o)&&S(r,o,t[o]);if(z)for(var o of z(t))M.call(t,o)&&S(r,o,t[o]);return r},x=(r,t)=>V(r,Y(t));var _=(r,t,o)=>new Promise((C,c)=>{var u=i=>{try{n(o.next(i))}catch(d){c(d)}},b=i=>{try{n(o.throw(i))}catch(d){c(d)}},n=i=>i.done?C(i.value):Promise.resolve(i.value).then(u,b);n((o=o.apply(r,t)).next())});import{W as U}from"./index-C4NAiFfA.js";import{dI as $,dJ as Z,dz as G,a7 as j}from"./bootstrap-DjYyHEgg.js";import{h as H,e as q}from"./fileTransfer-p8-3apt7.js";import{e as W}from"./table-FRaKquww.js";import{u as Q,_ as K}from"./useTableImport-CNd8lRg2.js";import{u as X}from"./useDownLoad-Cw45s4VH.js";import{u as ee}from"./useShopCheck-DKIjDUfz.js";import{ci as D,m as te,b9 as oe,aa as re,be as ie,ab as h,b2 as p,bJ as s,j as y,u as e,bL as O,ai as T,ad as ae,I as le,bb as se,bp as ne}from"../jse/index-index-rmdNY63r.js";import{p as E}from"./contast-C3bEivmW.js";import{u as de}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as me}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as pe}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:ce}=de(),v={toolbarConfig:{custom:!0,export:!1,refresh:!0,resizable:!0,zoom:!0,search:!1},columns:[{title:"序号",type:"seq",width:50},{field:"jzyBuyerCode",title:"采购商编号",width:150},{field:"jzySupplierCode",title:"供应商编号",width:280},{field:"jzyGroupCode",title:"分组编号",width:280},{field:"jzyTemplateCode",title:"模板编号",width:150},{field:"commonProductId",title:"商品编号",width:150},{field:"jzySupplyType",title:"供货方式",width:150},{field:"jzyRechargeUsername",title:"充值用户名",width:150},{field:"commonProductName",title:"商品名称",width:150},{field:"jzyQuantity",title:"数量",width:150},{field:"jzyTotalFaceValue",title:"总面值",width:150},{field:"jzyPurchaseDiscount",title:"采购折扣",width:150},{field:"commonPaidAmount",title:"采购金额",width:150},{field:"jzySupplyFaceValue",title:"供货面值",width:150},{field:"commonDueAmount",title:"供货金额",width:150},{field:"jzyServiceFee",title:"服务费",width:150},{field:"jzyPromotionFee",title:"推广费",width:150},{field:"commonOrderStatus",title:"状态",width:150},{field:"commonCreateTime",title:"订单时间",width:150},{field:"commonOrderNo",title:"SUP订单号",width:150},{field:"jzyMerchantOrderNo",title:"商户订单号",width:150},{field:"jzyMainOrderNo",title:"主订单号",width:150},{field:"jzyIsRefunded",title:"是否退款",width:150},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:r}){const t=E.find(o=>o.value===r);return t?t.label:r}}]},ue={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[ce.datetime("commonCreateTime","订单时间",[D().startOf("month"),D().endOf("month")]),{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"jzyBuyerCode",label:"采购商编号"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"jzySupplierCode",label:"供应商编号"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"commonOrderNo",label:"SUP订单号"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"jzyMerchantOrderNo",label:"商户订单号"},{component:"Select",componentProps:{allowClear:!0,options:E,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"}],fieldMappingTime:[["commonCreateTime",["commonCreateStartTime","commonCreateEndTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Ne=te({__name:"index",setup(r){const{checkShopSelected:t}=ee(),{bizImportType:o,bizImportTypeList:C,uploadFormRef:c,isError:u,extension:b,handleImport:n,ImportSettingButton:i}=Q({importTypeList:[{id:1,label:"导入数据",bizCode:"JZY_SALES_ORDER_DETAIL",isError:!1,auth:"basic:jzySalesOrderDetails:import"},{id:2,label:"导入异常数据",bizCode:"JZY_SALES_ORDER_DETAIL",isError:!0,auth:"basic:jzySalesOrderDetails:importFail"}],defaultExtension:".xlsx,.xls,.csv",errorExtension:".xlsx"}),d=oe($.supOrderDetailCommonCsv),P=m({},ue),k=x(m({},v),{toolbarConfig:m({},v.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(l,fe)=>_(null,[l,fe],function*({page:{currentPage:w,pageSize:a}},f){return t()?yield W(m({current:w,size:a},f)):{result:{records:[],total:0}}})}}}),I={},[L,g]=Z({gridEvents:I,formOptions:P,gridOptions:k}),{handleDownload:N,downLoading:F}=X(),{hasAccessByCodes:R}=G(),A=re(()=>R(["basic:jzySalesOrderDetails:list"]));return(w,a)=>{const f=ie("access");return A.value?(p(),h(e(me),{key:0,"auto-content-height":""},{default:s(()=>[y(e(L),null,{"toolbar-actions":s(()=>[(p(!0),ae(le,null,se(e(C),l=>O((p(),h(e(j),{key:l.id,type:"primary",style:{"margin-right":"12px"},onClick:fe=>e(n)(l.bizCode,l.isError,e(g))},{default:s(()=>[T(ne(l.label),1)]),_:2},1032,["onClick"])),[[f,[l.auth],"codes"]])),128))]),"toolbar-tools":s(()=>[O((p(),h(e(j),{loading:e(F),class:"mr-2",type:"primary",onClick:a[0]||(a[0]=l=>e(N)(e(g),d.value))},{icon:s(()=>[y(e(U),{class:"mr-1 inline-block size-6"})]),default:s(()=>[a[1]||(a[1]=T(" 导出数据 ",-1))]),_:1},8,["loading"])),[[f,["basic:jzySalesOrderDetails:export"],"codes"]]),y(e(i))]),_:1}),y(e(K),{ref_key:"uploadFormRef",ref:c,"biz-import-type":e(o),"is-error":e(u),"upload-fn":e(u)?e(q):e(H),extension:e(b)},null,8,["biz-import-type","is-error","upload-fn","extension"])]),_:1})):(p(),h(e(pe),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Ne as default};
