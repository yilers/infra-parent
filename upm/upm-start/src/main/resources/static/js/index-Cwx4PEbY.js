var B=Object.defineProperty,F=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var C=(a,t,e)=>t in a?B(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,p=(a,t)=>{for(var e in t||(t={}))U.call(t,e)&&C(a,e,t[e]);if(b)for(var e of b(t))V.call(t,e)&&C(a,e,t[e]);return a},_=(a,t)=>F(a,O(t));var m=(a,t,e)=>new Promise((r,d)=>{var g=o=>{try{l(e.next(o))}catch(c){d(c)}},y=o=>{try{l(e.throw(o))}catch(c){d(c)}},l=o=>o.done?r(o.value):Promise.resolve(o.value).then(g,y);l((e=e.apply(a,t)).next())});import{dJ as j,dz as E,dK as S}from"./bootstrap-DjYyHEgg.js";import{g as v,s as J,_ as L,h as M,a as N}from"./form.vue_vue_type_script_setup_true_lang-DoGs9-CV.js";import{h as P}from"./productMatch-mIhL3Voh.js";import{u as R}from"./useShopCheck-DKIjDUfz.js";import{_ as k}from"./table-action.vue_vue_type_style_index_0_lang-BluPqhNI.js";import{_ as q}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as H}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import{m as I,b9 as w,v as K,aa as Q,ab as x,b2 as T,bJ as f,j as h,u as i}from"../jse/index-index-rmdNY63r.js";import"./useDateRangePicker-DjB1zMnJ.js";import"./index-Bw6N7aDv.js";import"./shallowequal-W2RnI4nT.js";import"./index-CM6A-82x.js";import"./Dropdown-D1vLSWoc.js";import"./rotate-cw-Dzdn7gja.js";const de=I({__name:"index",setup(a){const{checkShopSelected:t}=R(),e=w([]),r=w(),d=_(p({},J),{collapsed:!0}),g=_(p({},v),{toolbarConfig:p({},v.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!1,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(fe,he)=>m(null,[fe,he],function*({page:{currentPage:s,pageSize:n}},u){return t()?yield M(p({current:s,size:n},u)):{result:{records:[],total:0}}})}}}),y={},[l,o]=j({gridEvents:y,formOptions:d,gridOptions:g}),c=()=>{t()&&(r.value.setData({isUpdate:!1,gridApi:o,categories:i(e)}),r.value.open())},A=s=>{r.value.setData({record:s,isUpdate:!0,gridApi:o,categories:i(e)}),r.value.open()},z=s=>m(null,null,function*(){yield N(s.id),S.success("删除成功"),o.reload()}),D=()=>m(null,null,function*(){if(t())try{const s=yield P();e.value=s.map(n=>({label:n.name,value:n.id})),o.formApi.updateSchema([{componentProps:{options:e.value},fieldName:"cardIds"}])}catch(s){S.error("获取分类失败")}});K(()=>{D()});const{hasAccessByCodes:G}=E(),$=Q(()=>G(["template:cardTypeSum:list"]));return(s,n)=>$.value?(T(),x(i(q),{key:0,"auto-content-height":""},{default:f(()=>[h(i(l),null,{"toolbar-actions":f(()=>[h(i(k),{actions:[{label:"新增卡种SUM项",type:"primary",icon:"ant-design:plus-outlined",auth:["template:cardTypeSum:add"],onClick:c.bind(null)}]},null,8,["actions"])]),"toolbar-tools":f(()=>[...n[0]||(n[0]=[])]),action:f(({row:u})=>[h(i(k),{actions:[{label:"编辑",icon:"ant-design:edit-outlined",type:"link",size:"small",auth:["template:cardTypeSum:edit"],onClick:A.bind(null,u)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",auth:["template:cardTypeSum:delete"],popConfirm:{title:"确定删除吗？",confirm:z.bind(null,u)}}]},null,8,["actions","drop-down-actions"])]),_:1}),h(L,{ref_key:"cardTypeSumFormRef",ref:r},null,512)]),_:1})):(T(),x(i(H),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}});export{de as default};
