var O=Object.defineProperty,q=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var I=(t,s,e)=>s in t?O(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,y=(t,s)=>{for(var e in s||(s={}))J.call(s,e)&&I(t,e,s[e]);if(_)for(var e of _(s))K.call(s,e)&&I(t,e,s[e]);return t},L=(t,s)=>q(t,E(s));var g=(t,s,e)=>new Promise((w,f)=>{var v=n=>{try{i(e.next(n))}catch(d){f(d)}},a=n=>{try{i(e.throw(n))}catch(d){f(d)}},i=n=>n.done?w(n.value):Promise.resolve(n.value).then(v,a);i((e=e.apply(t,s)).next())});import{bj as M,dJ as U}from"./bootstrap-DjYyHEgg.js";import{b as z}from"./pageTableConfig-CJVVeSTk.js";import{b as S}from"./index-BiD7armX.js";import{m as F,b9 as R,n as G,ab as H,b2 as N,u as A,bJ as T,j as Q}from"../jse/index-index-rmdNY63r.js";const $=F({__name:"choose-row-modal",props:{businessCategory:{default:""}},emits:["onSubmit"],setup(t,{expose:s,emit:e}){const w=t,f=e,v=R(!1),a=R(),i=R([]),[n,d]=M({onOpenChange(r){return g(this,null,function*(){var l,u,x,b;const o=d.getData();v.value=(l=o==null?void 0:o.isUpdate)!=null?l:!1;const h=(x=(u=o==null?void 0:o.defaultCheckedLists)==null?void 0:u.map(m=>m.rowId))!=null?x:[];i.value=[...(b=o==null?void 0:o.defaultCheckedLists)!=null?b:[]],a.value=r?h:[],r&&(yield G(),p.setGridOptions({checkboxConfig:{checkRowKeys:a.value}}))})},onConfirm(){return g(this,null,function*(){f("onSubmit",i.value),d.close()})}}),V=L(y({},S),{toolbarConfig:y({},S.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0,keyField:"id"},checkboxConfig:{highlight:!0,checkRowKeys:a.value},columnConfig:{resizable:!1},showOverflow:!1,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{enabled:!1},proxyConfig:{ajax:{query:()=>g(null,null,function*(){return{records:(yield z(w.businessCategory))||[]}})}}}),j={checkboxChange(){a.value=C().ids,i.value=C().lists},checkboxAll(){a.value=C().ids,i.value=C().lists},pageChange({$grid:r}){G(()=>g(null,null,function*(){yield r.commitProxy("query"),r.getData().filter(l=>{var u;return(u=a.value)==null?void 0:u.includes(l.id)}).forEach(l=>{r.setCheckboxRow(l,!0)})}))}},[B,p]=U({gridOptions:V,gridEvents:j});function C(){var m,P;const r=p.grid.getCheckboxReserveRecords(),o=p.grid.getCheckboxRecords(),h=p.grid.getData(),u=[...((m=a.value)==null?void 0:m.filter(c=>!h.some(k=>k.id===c)))||[],...r.map(c=>c.id),...o.map(c=>c.id)],b=[...(P=i.value)==null?void 0:P.filter(c=>!h.some(k=>k.id===c.id||k.id===c.rowId)),...r.map(c=>c),...o.map(c=>c)];return{ids:[...new Set(u)],lists:[...new Set(b)]}}return s(d),(r,o)=>(N(),H(A(n),{title:"选择",class:"h-[80%] w-[50%]","content-class":"h-[100%]"},{default:T(()=>[Q(A(B))]),_:1}))}});export{$ as _};
