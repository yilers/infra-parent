var W=Object.defineProperty,G=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var L=(t,e,r)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,u=(t,e)=>{for(var r in e||(e={}))K.call(e,r)&&L(t,r,e[r]);if(_)for(var r of _(e))Q.call(e,r)&&L(t,r,e[r]);return t},v=(t,e)=>G(t,U(e));var S=(t,e,r)=>new Promise((y,c)=>{var T=i=>{try{l(r.next(i))}catch(d){c(d)}},f=i=>{try{l(r.throw(i))}catch(d){c(d)}},l=i=>i.done?y(i.value):Promise.resolve(i.value).then(T,f);l((r=r.apply(t,e)).next())});import{W as X}from"./index-C4NAiFfA.js";import{dw as Z,dI as V,dJ as tt,dK as et,dz as ot,a7 as j}from"./bootstrap-DjYyHEgg.js";import{h as rt,l as it}from"./fileTransfer-p8-3apt7.js";import{f as at,m as st}from"./table-FRaKquww.js";import{u as nt,_ as lt}from"./useTableImport-CNd8lRg2.js";import{u as dt}from"./useDownLoad-Cw45s4VH.js";import{u as mt}from"./useDynamicTable-T14ukGXG.js";import{u as ut}from"./useShopCheck-DKIjDUfz.js";import{ci as B,m as pt,b9 as N,v as ct,aa as ft,be as ht,ab as b,b2 as p,bJ as s,j as C,u as o,ae as gt,bp as k,bL as I,ai as E,ad as bt,I as Ct,bb as yt}from"../jse/index-index-rmdNY63r.js";import{p as P}from"./contast-C3bEivmW.js";import{u as Tt}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as xt}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as Dt}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./pageTableConfig-CJVVeSTk.js";import"./tool-BzPbNkcJ.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:St}=Tt(),w={toolbarConfig:{resizable:!0},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"id",title:"主键ID",width:180},{field:"commonOrderNo",title:"订单编号"},{field:"commonPayTradeNo",title:"单据编号"},{field:"jdBillType",title:"单据类型"},{field:"commonProductId",title:"商品编号"},{field:"commonMerchantOrderNo",title:"商户订单号"},{field:"commonProductName",title:"商品名称"},{field:"jdSettlementStatus",title:"结算状态"},{field:"jdCreateTime",title:"费用发生时间"},{field:"jdFeeTime",title:"费用计费时间"},{field:"commonTransactionTime",title:"费用结算时间"},{field:"commonBusinessDescription",title:"费用项"},{field:"commonIncomeAmount",title:"收入金额"},{field:"commonExpenseAmount",title:"支出金额"},{field:"jdCurrency",title:"币种"},{field:"jdMerchantPayments",title:"商家实收/应付"},{field:"commonRemark",title:"钱包结算备注"},{field:"jdMerchantNo",title:"店铺号"},{field:"jdStoreNo",title:"京东门店编号",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"jdBrandNo",title:"品牌门店编号",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"jdStoreName",title:"门店名称",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonBusinessType",title:"收支方向"},{field:"jdQuantity",title:"商品数量"},{field:"jdBillDate",title:"对账日期"},{field:"jdRemark",title:"备注",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"nature",title:"性质",width:270,slots:{default:"natureValue"}},{field:"failedReason",title:"异常原因",width:150,formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"natureStr",title:"性质",width:270},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:t}){const e=P.find(r=>r.value===t);return e?e.label:t}},{field:"commonSupplyOrderNo",title:"供货订单号",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonSupplyProductId",title:"供货商品ID",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonSupplyProductName",title:"供货商品名称",formatter({cellValue:t}){return t===null||t===""?"--":t}}]},wt={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[St.datetime("date","账单时间",[B().startOf("month"),B().endOf("month")]),{component:"Select",componentProps:{allowClear:!0,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6,showSearch:!0,filterOption:(t,e)=>e.label.toLowerCase().includes(t.toLowerCase())},fieldName:"natureList",label:"性质"},{component:"Select",componentProps:{allowClear:!0,options:P,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"}],fieldMappingTime:[["date",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Ut=pt({__name:"index",setup(t){const{queryWithColumns:e}=mt({staticColumns:w.columns,pageCode:Z.JDTransactionDetails,queryFn:st}),{checkShopSelected:r}=ut(),{bizImportType:y,bizImportTypeList:c,uploadFormRef:T,isError:f,extension:l,handleImport:i,ImportSettingButton:d}=nt({importTypeList:[{id:1,label:"导入数据",bizCode:"JD_TRADE_BILL_DETAIL",isError:!1,auth:"basic:jdTransactionStatementDetails:import"},{id:2,label:"导入异常数据",bizCode:"JD_TRADE_BILL_DETAIL",isError:!0,auth:"basic:jdTransactionStatementDetails:importFail"}],defaultExtension:".xls,.xlsx,.csv",errorExtension:".xls,.xlsx,.csv"}),z=N(V.jdTradeBillDetailCsv),A=u({},wt),F=v(u({},w),{toolbarConfig:u({},w.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1,width:"auto"},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(a,D)=>S(null,[a,D],function*({page:{currentPage:m,pageSize:n}},g){return r()?yield e(h,u({current:m,size:n},g)):{result:{records:[],total:0}}})}}}),O={},[R,h]=tt({gridEvents:O,formOptions:A,gridOptions:F});ct(()=>{J()});const x=N([]),J=()=>S(null,null,function*(){try{const m=yield at({payeePlatformValue:9});x.value=m,h.formApi.updateSchema([{componentProps:{options:x.value},fieldName:"natureList"}])}catch(m){et.error("获取性质失败")}}),{handleDownload:M,downLoading:$}=dt(),{hasAccessByCodes:q}=ot(),Y=ft(()=>q(["basic:jdTransactionStatementDetails:list"]));return(m,n)=>{const g=ht("access");return Y.value?(p(),b(o(xt),{key:0,"auto-content-height":""},{default:s(()=>[C(o(R),null,{"toolbar-actions":s(()=>[(p(!0),bt(Ct,null,yt(o(c),a=>I((p(),b(o(j),{key:a.id,type:"primary",style:{"margin-right":"12px"},onClick:D=>o(i)(a.bizCode,a.isError,o(h))},{default:s(()=>[E(k(a.label),1)]),_:2},1032,["onClick"])),[[g,[a.auth],"codes"]])),128))]),"toolbar-tools":s(()=>[I((p(),b(o(j),{loading:o($),class:"mr-2",type:"primary",onClick:n[0]||(n[0]=a=>o(M)(o(h),z.value))},{icon:s(()=>[C(o(X),{class:"mr-1 inline-block size-6"})]),default:s(()=>[n[1]||(n[1]=E(" 导出数据 ",-1))]),_:1},8,["loading"])),[[g,["basic:jdTransactionStatementDetails:export"],"codes"]]),C(o(d))]),natureValue:s(({row:a})=>{var D;return[gt("div",null,k(((D=x.value.find(H=>H.value===a.nature))==null?void 0:D.label)||a.nature),1)]}),_:1}),C(o(lt),{ref_key:"uploadFormRef",ref:T,"biz-import-type":o(y),extension:o(l),"is-error":o(f),"upload-fn":o(f)?o(it):o(rt)},null,8,["biz-import-type","extension","is-error","upload-fn"])]),_:1})):(p(),b(o(Dt),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Ut as default};
