var E=Object.defineProperty,L=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var A=(t,r,n)=>r in t?E(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,m=(t,r)=>{for(var n in r||(r={}))W.call(r,n)&&A(t,n,r[n]);if(o)for(var n of o(r))$.call(r,n)&&A(t,n,r[n]);return t},p=(t,r)=>L(t,R(r));var P=(t,r,n)=>new Promise((s,i)=>{var d=c=>{try{f(n.next(c))}catch(g){i(g)}},e=c=>{try{f(n.throw(c))}catch(g){i(g)}},f=c=>c.done?s(c.value):Promise.resolve(c.value).then(d,e);f((n=n.apply(t,r)).next())});import{c$ as q,d0 as I,d1 as U,d2 as X,d3 as Q,d4 as G,d5 as H,d6 as J,d7 as b,d8 as Y,d9 as Z,da as z,db as x,dc as k,dd as V,de as l,df as j,dg as T,dh as C,di as v,dj as _,dk as tt,dl as rt,dm as et,dn as N,dp as nt,cU as D,cQ as K,cR as st,dq as O,dr as it,cV as ft,ds as ct,dt,c_ as at,cX as ut,b5 as w,du as yt,dv as gt}from"./bootstrap-B0IOIL79.js";import{m as h}from"./crypto-BIPOTUv7.js";import"./index-DL4br4xk.js";import{m as mt,ad as pt,b2 as wt,j as Ot,u as ot}from"../jse/index-index-StHjciy-.js";function At(t){return t==null||typeof t!="object"&&typeof t!="function"}function Pt(t,r){return u(t,void 0,t,new Map,r)}function u(t,r,n,s=new Map,i=void 0){const d=i==null?void 0:i(t,r,n,s);if(d!==void 0)return d;if(At(t))return t;if(s.has(t))return s.get(t);if(Array.isArray(t)){const e=new Array(t.length);s.set(t,e);for(let f=0;f<t.length;f++)e[f]=u(t[f],f,n,s,i);return Object.hasOwn(t,"index")&&(e.index=t.index),Object.hasOwn(t,"input")&&(e.input=t.input),e}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const e=new RegExp(t.source,t.flags);return e.lastIndex=t.lastIndex,e}if(t instanceof Map){const e=new Map;s.set(t,e);for(const[f,c]of t)e.set(f,u(c,f,n,s,i));return e}if(t instanceof Set){const e=new Set;s.set(t,e);for(const f of t)e.add(u(f,void 0,n,s,i));return e}if(typeof Buffer!="undefined"&&Buffer.isBuffer(t))return t.subarray();if(q(t)){const e=new(Object.getPrototypeOf(t)).constructor(t.length);s.set(t,e);for(let f=0;f<t.length;f++)e[f]=u(t[f],f,n,s,i);return e}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer!="undefined"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const e=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return s.set(t,e),a(e,t,n,s,i),e}if(typeof File!="undefined"&&t instanceof File){const e=new File([t],t.name,{type:t.type});return s.set(t,e),a(e,t,n,s,i),e}if(typeof Blob!="undefined"&&t instanceof Blob){const e=new Blob([t],{type:t.type});return s.set(t,e),a(e,t,n,s,i),e}if(t instanceof Error){const e=new t.constructor;return s.set(t,e),e.message=t.message,e.name=t.name,e.stack=t.stack,e.cause=t.cause,a(e,t,n,s,i),e}if(t instanceof Boolean){const e=new Boolean(t.valueOf());return s.set(t,e),a(e,t,n,s,i),e}if(t instanceof Number){const e=new Number(t.valueOf());return s.set(t,e),a(e,t,n,s,i),e}if(t instanceof String){const e=new String(t.valueOf());return s.set(t,e),a(e,t,n,s,i),e}if(typeof t=="object"&&ht(t)){const e=Object.create(Object.getPrototypeOf(t));return s.set(t,e),a(e,t,n,s,i),e}return t}function a(t,r,n=t,s,i){const d=[...Object.keys(r),...I(r)];for(let e=0;e<d.length;e++){const f=d[e],c=Object.getOwnPropertyDescriptor(t,f);(c==null||c.writable)&&(t[f]=u(r[f],f,n,s,i))}}function ht(t){switch(U(t)){case N:case et:case rt:case tt:case _:case v:case C:case T:case j:case l:case V:case k:case x:case z:case Z:case Y:case b:case J:case H:case G:case Q:case X:return!0;default:return!1}}function St(t,r){return Pt(t,(n,s,i,d)=>{const e=r==null?void 0:r(n,s,i,d);if(e!==void 0)return e;if(typeof t=="object")switch(Object.prototype.toString.call(t)){case x:case b:case _:{const f=new t.constructor(t==null?void 0:t.valueOf());return a(f,t),f}case N:{const f={};return a(f,t),f.length=t.length,f[Symbol.iterator]=t[Symbol.iterator],f}default:return}})}function Bt(t){return nt(t)?NaN:Number(t)}function It(t){return t?(t=Bt(t),t===1/0||t===-1/0?(t<0?-1:1)*Number.MAX_VALUE:t===t?t:0):t===0?t:0}function bt(t){const r=It(t),n=r%1;return n?r-n:r}function xt(t,r=1){const n=[],s=Math.floor(r);if(!D(t))return n;const i=(d,e)=>{for(let f=0;f<d.length;f++){const c=d[f];e<s&&(Array.isArray(c)||c!=null&&c[Symbol.isConcatSpreadable]||c!==null&&typeof c=="object"&&Object.prototype.toString.call(c)==="[object Arguments]")?Array.isArray(c)?i(c,e+1):i(Array.from(c),e+1):n.push(c)}};return i(Array.from(t),0),n}function S(t,r){if(t==null)return!0;switch(typeof r){case"symbol":case"number":case"object":{if(Array.isArray(r))return B(t,r);if(typeof r=="number"?r=it(r):typeof r=="object"&&(Object.is(r==null?void 0:r.valueOf(),-0)?r="-0":r=String(r)),O(r))return!1;if((t==null?void 0:t[r])===void 0)return!0;try{return delete t[r],!0}catch(n){return!1}}case"string":{if((t==null?void 0:t[r])===void 0&&K(r))return B(t,st(r));if(O(r))return!1;try{return delete t[r],!0}catch(n){return!1}}}}function B(t,r){const n=r.length===1?t:ft(t,r.slice(0,-1)),s=r[r.length-1];if((n==null?void 0:n[s])===void 0)return!0;if(O(s))return!1;try{return delete n[s],!0}catch(i){return!1}}function _t(t){return typeof Buffer!="undefined"&&Buffer.isBuffer(t)}function Nt(t,r){if(t=bt(t),t<1||!Number.isSafeInteger(t))return[];const n=new Array(t);for(let s=0;s<t;s++)n[s]=typeof r=="function"?r(s):s;return n}function F(t){if(t==null)return[];switch(typeof t){case"object":case"function":return D(t)?Kt(t):ct(t)?Dt(t):y(t);default:return y(Object(t))}}function y(t){const r=[];for(const n in t)r.push(n);return r}function Dt(t){return y(t).filter(n=>n!=="constructor")}function Kt(t){const r=Nt(t.length,i=>`${i}`),n=new Set(r);_t(t)&&(n.add("offset"),n.add("parent")),dt(t)&&(n.add("buffer"),n.add("byteLength"),n.add("byteOffset"));const s=y(t).filter(i=>!n.has(i));return Array.isArray(t)?[...r,...s]:[...r.filter(i=>Object.hasOwn(t,i)),...s]}function Ft(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const s=t[Symbol.toStringTag];return s==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${s}]`}let r=t;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(t)===r}function M(t){const r=[];for(;t;)r.push(...I(t)),t=Object.getPrototypeOf(t);return r}function Mt(t,...r){if(t==null)return{};r=xt(r);const n=Et(t,r);for(let s=0;s<r.length;s++){let i=r[s];switch(typeof i){case"object":{Array.isArray(i)||(i=Array.from(i));for(let d=0;d<i.length;d++){const e=i[d];S(n,e)}break}case"string":case"symbol":case"number":{S(n,i);break}}}return n}function Et(t,r){return r.some(s=>Array.isArray(s)||K(s))?Rt(t):Lt(t)}function Lt(t){const r={},n=[...F(t),...M(t)];for(let s=0;s<n.length;s++){const i=n[s];r[i]=t[i]}return r}function Rt(t){const r={},n=[...F(t),...M(t)];for(let s=0;s<n.length;s++){const i=n[s];r[i]=St(t[i],d=>{if(!Ft(d))return d})}return r}function Wt(t){const r={oldPwd:h(t.oldPwd),newPwd:h(t.newPwd)};return at.post("/user/updatePwd",r)}const $t={class:"mt-[16px] md:w-full lg:w-1/2 2xl:w-2/5"},Ht=mt({__name:"secure-setting",setup(t){const[r,n]=ut({commonConfig:{labelWidth:90},handleSubmit:d,resetButtonOptions:{show:!1},schema:[{component:"InputPassword",fieldName:"oldPwd",label:"旧密码",rules:w({message:"请输入密码"}).min(5,"密码长度不能少于5个字符").max(20,"密码长度不能超过20个字符")},{component:"InputPassword",dependencies:{rules(e){return w({message:"请输入新密码"}).min(5,"密码长度不能少于5个字符").max(20,"密码长度不能超过20个字符").refine(f=>f!==e.oldPwd,"新旧密码不能相同")},triggerFields:["newPwd","oldPwd"]},fieldName:"newPwd",label:"新密码",rules:"required"},{component:"InputPassword",dependencies:{rules(e){return w({message:"请输入确认密码"}).min(5,"密码长度不能少于5个字符").max(20,"密码长度不能超过20个字符").refine(f=>f===e.newPwd,"新密码和确认密码不一致")},triggerFields:["newPwd","confirmPassword"]},fieldName:"confirmPassword",label:"确认密码",rules:"required"}],submitButtonOptions:{content:"修改密码"}});function s(e){n.setState(f=>p(m({},f),{submitButtonOptions:p(m({},f.submitButtonOptions),{loading:e})}))}const i=yt();function d(e){gt.confirm({content:"确认修改密码吗？",onOk:()=>P(null,null,function*(){try{s(!0);const f=Mt(e,["confirmPassword"]);yield Wt(f),yield i.logout(!0)}catch(f){console.error(f)}finally{s(!1)}}),title:"提示"})}return(e,f)=>(wt(),pt("div",$t,[Ot(ot(r))]))}});export{Ht as _};
