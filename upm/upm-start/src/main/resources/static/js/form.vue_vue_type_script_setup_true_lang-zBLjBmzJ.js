var _=Object.defineProperty,x=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var v=(e,a,t)=>a in e?_(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,C=(e,a)=>{for(var t in a||(a={}))R.call(a,t)&&v(e,t,a[t]);if(y)for(var t of y(a))A.call(a,t)&&v(e,t,a[t]);return e},M=(e,a)=>x(e,S(a));var n=(e,a,t)=>new Promise((c,u)=>{var i=s=>{try{o(t.next(s))}catch(m){u(m)}},h=s=>{try{o(t.throw(s))}catch(m){u(m)}},o=s=>s.done?c(s.value):Promise.resolve(s.value).then(i,h);o((t=t.apply(e,a)).next())});import{dy as d,d_ as W,dL as L,bj as V,dK as q,dx as k}from"./bootstrap-DjYyHEgg.js";import{u as O}from"./useDateRangePicker-DjB1zMnJ.js";import{m as B,b9 as N,aa as D,ab as F,b2 as Y,u as P,bJ as j,ae as H,j as $}from"../jse/index-index-rmdNY63r.js";function z(e){return n(this,null,function*(){return d.post("/sourceCustomMerchantRel/add",e)})}function E(e){return n(this,null,function*(){return d.post("/sourceCustomMerchantRel/update",e)})}function te(e){return n(this,null,function*(){return d.post("/sourceCustomMerchantRel/pageList",e)})}function ae(e){return n(this,null,function*(){return d.post(`/sourceCustomMerchantRel/delete/${e}`)})}const{dateRangePresets:J}=O(),g=[{label:"采购商",value:"buyer"},{label:"供应商",value:"supplier"}],le={toolbarConfig:{resizable:!0},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"merchantCode",title:"商户编号"},{field:"merchantName",title:"商户名称"},{field:"merchantCategory",title:"所属分类"},{field:"merchantType",title:"商户类型",formatter({row:e,cellValue:a}){var t;return((t=g.find(c=>c.value===e.merchantType))==null?void 0:t.label)||a}},{field:"sortNumber",title:"排序"},{field:"createTime",title:"创建时间"},{width:200,title:"操作",align:"center",slots:{default:"action"},fixed:"right"}]},oe={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[J.datetime("createTime","创建时间"),{labelWidth:70,fieldName:"merchantType",label:"商户类型",component:"Select",componentProps:{placeholder:"请选择商户类型",allowClear:!0,showSearch:!0,options:g,fieldNames:{label:"label",value:"value"},filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase())}},{labelWidth:70,fieldName:"merchantCode",label:"商户编号",component:"Input",componentProps:{placeholder:"请输入商户编号",allowClear:!0}}],fieldMappingTime:[["createTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!1,submitOnChange:!1,submitOnEnter:!1},K={wrapperClass:"flex",commonConfig:{formItemClass:"col-span-12",labelWidth:70},schema:[{fieldName:"id",label:"平台ID",component:"Input",dependencies:{show:!1,triggerFields:["id"]}},{labelWidth:70,fieldName:"merchantType",label:"商户类型",component:"Select",componentProps:{placeholder:"请选择商户类型",allowClear:!0,class:"w-full",showSearch:!0,options:g,fieldNames:{label:"label",value:"value"},filterOption:(e,a)=>a.label.toLowerCase().includes(e.toLowerCase())},formItemClass:"col-span-12",rules:"selectRequired"},{labelWidth:70,fieldName:"merchantCode",label:"商户编号",component:"Input",componentProps:{placeholder:"请输入商户编号",allowClear:!0},formItemClass:"col-span-12",rules:"required"},{labelWidth:70,fieldName:"merchantName",label:"商户名称",component:"Input",componentProps:{placeholder:"请输入商户名称",allowClear:!0},formItemClass:"col-span-12",rules:"required"},{labelWidth:70,fieldName:"merchantCategory",label:"所属分类",component:"Input",componentProps:{placeholder:"请输入所属分类",allowClear:!0},formItemClass:"col-span-12",rules:"required"},{labelWidth:70,fieldName:"sortNumber",label:"排序",component:"InputNumber",componentProps:{placeholder:"请输入排序",allowClear:!0,class:"w-full",min:0,max:999},formItemClass:"col-span-12",rules:W({message:"请输入数字"}).int({message:"请输入整数"})}]},U={class:"common-form"},se=B({__name:"form",setup(e,{expose:a}){const t=N({}),c=N(),[u,i]=L(C({showDefaultActions:!1},K)),[h,o]=V({onOpenChange(r){const l=o.getData();c.value=r?l==null?void 0:l.gridApi:null,t.value=r?(l==null?void 0:l.record)||{}:{},i.setValues(t.value)},onConfirm(){return n(this,null,function*(){var l,p;if((yield i.validate()).valid)try{o.lock(!0);const f=yield i.getValues(),b=yield s(f);yield((l=t.value)!=null&&l.id?E:z)(b),q.success("保存成功"),(p=c.value)==null||p.reload(),o.close()}finally{o.lock(!1)}})}});function s(r){return n(this,null,function*(){const{id:l,merchantCategory:p,merchantCode:f,merchantName:b,merchantType:w,sortNumber:I}=r,{selectedShopId:T}=k();return M(C({},l&&{id:l}),{merchantCategory:p,merchantCode:f,merchantName:b,merchantType:w,sortNumber:I,shopId:T})})}const m=D(()=>{var r;return(r=t.value)!=null&&r.id?"编辑商户":"新增商户"});return a(o),(r,l)=>(Y(),F(P(h),{title:m.value,class:"w-300px"},{default:j(()=>[H("div",U,[$(P(u))])]),_:1},8,["title"]))}});export{se as _,ae as a,le as g,te as h,oe as s};
