var N=Object.defineProperty,j=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var k=(a,e,t)=>e in a?N(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,u=(a,e)=>{for(var t in e||(e={}))E.call(e,t)&&k(a,t,e[t]);if(w)for(var t of w(e))I.call(e,t)&&k(a,t,e[t]);return a},v=(a,e)=>j(a,q(e));var l=(a,e,t)=>new Promise((r,i)=>{var b=s=>{try{c(t.next(s))}catch(d){i(d)}},h=s=>{try{c(t.throw(s))}catch(d){i(d)}},c=s=>s.done?r(s.value):Promise.resolve(s.value).then(b,h);c((t=t.apply(a,e)).next())});import{dJ as J,dz as R,dK as _}from"./bootstrap-DjYyHEgg.js";import{l as H,m as K,b as U,i as Q,n as W}from"./index-BWhM0zNP.js";import{u as X}from"./useShopCheck-DKIjDUfz.js";import{_ as Y}from"./form.vue_vue_type_script_setup_true_lang-CNVAwv9b.js";import{g as A,s as Z}from"./index-BiID8tjB.js";import{_ as tt}from"./table-configuration-modal.vue_vue_type_script_setup_true_lang-9najG6Tx.js";import{_ as P}from"./table-action.vue_vue_type_style_index_0_lang-BluPqhNI.js";import{_ as et}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as ot}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import{m as at,b9 as g,v as nt,aU as st,aa as rt,ab as D,b2 as B,bJ as C,j as f,u as n}from"../jse/index-index-rmdNY63r.js";import{u as it}from"./use-drawer-CB92zaEG.js";import"./index-C4NAiFfA.js";import"./table-form.vue_vue_type_script_setup_true_lang-9KSMpnah.js";import"./index-Bw6N7aDv.js";import"./shallowequal-W2RnI4nT.js";import"./index-CM6A-82x.js";import"./Dropdown-D1vLSWoc.js";import"./rotate-cw-Dzdn7gja.js";const Bt=at({__name:"index",setup(a){const{checkShopSelected:e}=X(),t=g([]),r=g([]),i=g(),[b,h]=it({appendToMain:!0,connectedComponent:Y,destroyOnClose:!0}),c=u({},Z),s=v(u({},A),{toolbarConfig:u({},A.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(zt,Lt)=>l(null,[zt,Lt],function*({page:{currentPage:o,pageSize:S}},m){return yield H(u({current:o,size:S},m))})}}}),d={},[M,p]=J({gridEvents:d,formOptions:c,gridOptions:s}),x=()=>{e()&&h.setData({gridApi:p,brandSelect:n(t),platformSelect:n(r)}).open()},z=o=>{e()&&h.setData({record:o,gridApi:p,brandSelect:n(t),platformSelect:n(r)}).open()},L=o=>{i.value.setData({record:o,tableStatusList:n(y)}),i.value.open()},F=o=>l(null,null,function*(){e()&&(yield K(o.id),_.success("删除成功"),p.query())}),$=()=>l(null,null,function*(){try{const o=yield U({current:1,size:200,name:""});t.value=o.records,p.formApi.updateSchema([{componentProps:{options:t.value},fieldName:"brandId"}])}catch(o){_.error("获取品牌分类失败")}}),O=()=>l(null,null,function*(){try{const o=yield Q({current:1,size:200,name:""});r.value=o.records,p.formApi.updateSchema([{componentProps:{options:r.value},fieldName:"platformId"}])}catch(o){_.error("获取平台分类失败")}}),y=g([]),T=()=>l(null,null,function*(){y.value=yield W()});nt(()=>{$(),O(),T()}),st(()=>{});const{hasAccessByCodes:V}=R(),G=rt(()=>V(["store:storeManagement:list"]));return(o,S)=>G.value?(B(),D(n(et),{key:0,"auto-content-height":""},{default:C(()=>[f(n(b)),f(tt,{ref_key:"tableConfigurationModalRef",ref:i},null,512),f(n(M),null,{"toolbar-actions":C(()=>[f(n(P),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["store:storeManagement:add"],onClick:x.bind(null)}]},null,8,["actions"])]),action:C(({row:m})=>[f(n(P),{actions:[{label:"编辑",icon:"ant-design:edit-outlined",type:"link",size:"small",auth:["store:storeManagement:edit"],onClick:z.bind(null,m)},{label:"查看表配置",icon:"ant-design:edit-outlined",type:"link",size:"small",auth:["store:storeManagement:edit"],onClick:L.bind(null,m)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:!1,popConfirm:{title:"确定删除吗？",confirm:F.bind(null,m)}}]},null,8,["actions","drop-down-actions"])]),_:1})]),_:1})):(B(),D(n(ot),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}});export{Bt as default};
