var R=Object.defineProperty;var C=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var _=(r,s,e)=>s in r?R(r,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[s]=e,A=(r,s)=>{for(var e in s||(s={}))F.call(s,e)&&_(r,e,s[e]);if(C)for(var e of C(s))J.call(s,e)&&_(r,e,s[e]);return r};var b=(r,s,e)=>new Promise((u,n)=>{var d=o=>{try{l(e.next(o))}catch(p){n(p)}},i=o=>{try{l(e.throw(o))}catch(p){n(p)}},l=o=>o.done?u(o.value):Promise.resolve(o.value).then(d,i);l((e=e.apply(r,s)).next())});import{dL as M,bj as T,dw as O,dX as v,dK as k}from"./bootstrap-DjYyHEgg.js";import{e as U,f as q}from"./pageTableConfig-CJVVeSTk.js";import{g as K}from"./contast-C3bEivmW.js";import{p as L}from"./index-BiD7armX.js";import{m as X,b9 as x,b$ as $,ad as z,b2 as G,j as w,u as S,bJ as H}from"../jse/index-index-rmdNY63r.js";const ae=X({__name:"form",setup(r,{expose:s}){const e=x({}),u=x(!1),n=x(),[d,i]=M(A({showDefaultActions:!1},L)),[l,o]=T({onOpenChange(a){return b(this,null,function*(){var c;const t=o.getData();u.value=(c=t==null?void 0:t.isUpdate)!=null?c:!1,e.value=$(t.record||{}),p(t.record),n.value=a?t==null?void 0:t.gridApi:null,i.setValues(e.value)})},onConfirm(){return b(this,null,function*(){var a,t,c,h;try{const{valid:g}=yield i.validate();if(!g)return;o.lock(!0);const V=yield i.getValues(),{tabName:B,remark:E,pageCode:f,extra:m}=V,N=m&&typeof m=="object"&&Object.keys(m).length>0?JSON.stringify(m):"",y={tabCode:e.value.tabCode||"",pageCode:f,tabName:B,remark:E,pageName:((a=K.find(P=>P.value===f))==null?void 0:a.label)||"",extra:N,businessCategory:f===O.ShopOperationReport?v.Operation:f===O.BiReport?v.BiReport:v.Sale};(t=e.value)!=null&&t.id&&(y.id=e.value.id),yield((c=e.value)!=null&&c.id?U:q)(y),k.success("保存成功"),(h=n.value)==null||h.query(),o.close()}catch(g){j(g)}finally{o.lock(!1)}})}}),p=a=>{if(Object.keys(e.value).length>0&&(a!=null&&a.extra))try{const t=typeof a.extra=="string"?JSON.parse(a.extra):a.extra;Object.assign(e.value,{extra:t})}catch(t){e.value.extra={}}};function j(a){k.error(a instanceof Error?a.message:"保存失败，请检查网络或联系管理员")}return s(o),(a,t)=>(G(),z("div",null,[w(S(l),{title:u.value?"编辑":"新增Tab页面",class:"w-300px"},{default:H(()=>[w(S(d))]),_:1},8,["title"])]))}});export{ae as _};
