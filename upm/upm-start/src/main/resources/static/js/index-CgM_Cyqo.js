var G=Object.defineProperty,H=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var v=(e,t,i)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,m=(e,t)=>{for(var i in t||(t={}))J.call(t,i)&&v(e,i,t[i]);if(S)for(var i of S(t))K.call(t,i)&&v(e,i,t[i]);return e},_=(e,t)=>H(e,W(t));var A=(e,t,i)=>new Promise((y,p)=>{var x=a=>{try{s(i.next(a))}catch(d){p(d)}},f=a=>{try{s(i.throw(a))}catch(d){p(d)}},s=a=>a.done?y(a.value):Promise.resolve(a.value).then(x,f);s((i=i.apply(e,t)).next())});import{W as Q}from"./index-C4NAiFfA.js";import{dw as X,dI as Z,dJ as ee,dK as te,dz as oe,a7 as D}from"./bootstrap-DjYyHEgg.js";import{h as ie,f as ae}from"./fileTransfer-p8-3apt7.js";import{f as re,g as le}from"./table-FRaKquww.js";import{u as ne,_ as se}from"./useTableImport-CNd8lRg2.js";import{u as de}from"./useDownLoad-Cw45s4VH.js";import{u as ce}from"./useDynamicTable-T14ukGXG.js";import{u as me}from"./useShopCheck-DKIjDUfz.js";import{ci as L,m as ue,b9 as I,v as pe,aa as fe,be as he,ab as C,b2 as u,bJ as l,j as b,u as o,ae as we,bp as P,bL as k,ai as B,ad as ge,I as Ce,bb as be}from"../jse/index-index-rmdNY63r.js";import{p as O}from"./contast-C3bEivmW.js";import{u as ye}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as xe}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as Ne}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./pageTableConfig-CJVVeSTk.js";import"./tool-BzPbNkcJ.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:Ae}=ye(),T={toolbarConfig:{resizable:!0,search:!1},columns:[{title:"序号",type:"seq",width:50},{field:"id",title:"主键ID",width:180},{field:"commonPayTradeNo",title:"账务流水号",width:240},{field:"nature",title:"性质",width:270,slots:{default:"natureValue"}},{field:"natureStr",title:"性质",width:240,formatter({cellValue:e}){return e===null?"--":e}},{field:"failedReason",title:"异常原因",width:240,formatter({cellValue:e}){return e===null?"--":e}},{field:"aliBusinessSerialNo",title:"业务流水号",width:280},{field:"commonProductId",title:"销售商品ID",width:240},{field:"commonProductName",title:"商品名称",width:420},{field:"commonSupplyOrderNo",title:"供货订单号",width:240},{field:"commonSupplyProductName",title:"供货商品名称",width:280},{field:"commonSupplyProductId",title:"供货商品ID",width:240},{field:"commonTransactionTime",title:"发生时间",width:160},{field:"commonIncomeAmount",title:"收入金额（+元）",width:150},{field:"commonExpenseAmount",title:"支出金额（-元）",width:150},{field:"aliAccountBalance",title:"账户余额（元）",width:150},{field:"aliTransactionChannel",title:"交易渠道",width:200},{field:"commonBusinessType",title:"业务类型",width:200},{field:"commonRemark",title:"备注",width:460,align:"left"},{field:"commonMerchantOrderNo",title:"商户订单号",width:420,align:"left"},{field:"aliCounterAccount",title:"对方账号",width:360},{field:"commonOrderNo",title:"业务基础订单号",width:240},{field:"aliFeeRate",title:"费率",width:140},{field:"aliBusinessOrderNo",title:"业务订单号",width:360},{field:"commonBusinessDescription",title:"业务描述",width:420},{field:"aliBillSource",title:"业务账单来源",width:180},{field:"aliSignedProduct",title:"签约产品",width:200},{field:"aliRefundBatchNo",title:"退款批次号",width:240},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:e}){const t=O.find(i=>i.value===e);return t?t.label:e}},{field:"createTime",title:"创建时间",width:160}]},Te={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[Ae.datetime("transactionTime","发生时间",[L().startOf("month"),L().endOf("month")]),{component:"Select",componentProps:{allowClear:!0,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6,showSearch:!0,filterOption:(e,t)=>t.label.toLowerCase().includes(e.toLowerCase())},fieldName:"natureList",label:"性质"},{component:"Select",componentProps:{allowClear:!0,options:O,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"productName",label:"商品名称"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"accountSerialNo",label:"账务流水号"},{component:"Input",componentProps:{allowClear:!0},fieldName:"counterAccount",label:"对方账号"},{component:"Input",componentProps:{allowClear:!0},fieldName:"baseOrderNo",label:"业务基础订单号"}],fieldMappingTime:[["transactionTime",["transactionStartTime","transactionEndTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},We=ue({__name:"index",setup(e){const{checkShopSelected:t}=me(),{queryWithColumns:i}=ce({staticColumns:T.columns,pageCode:X.AlipayAccountDetail,queryFn:le}),{bizImportType:y,bizImportTypeList:p,uploadFormRef:x,isError:f,extension:s,handleImport:a,ImportSettingButton:d}=ne({importTypeList:[{id:1,label:"导入数据",bizCode:"ALI_ACCOUNT",isError:!1,auth:"basic:alipayAccountDetail:import"},{id:2,label:"导入异常数据",bizCode:"ALI_ACCOUNT",isError:!0,auth:"basic:alipayAccountDetail:importFail"}],defaultExtension:".csv,.xlsx,.xls",errorExtension:".xlsx"}),z=I(Z.alipayAccountDetailCsv),E=m({},Te),F=_(m({},T),{toolbarConfig:m({},T.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(r,N)=>A(null,[r,N],function*({page:{currentPage:c,pageSize:n}},g){return t()?yield i(h,m({current:c,size:n},g)):{result:{records:[],total:0}}})}}}),R={},[V,h]=ee({gridEvents:R,formOptions:E,gridOptions:F});pe(()=>{M()});const w=I([]),M=()=>A(null,null,function*(){try{w.value=[];const c=yield re({});w.value=c,h.formApi.updateSchema([{componentProps:{options:w.value},fieldName:"natureList"}])}catch(c){te.error("获取性质失败")}}),{handleDownload:$,downLoading:q}=de(),{hasAccessByCodes:U}=oe(),Y=fe(()=>U(["basic:alipayAccountDetail:list"]));return(c,n)=>{const g=he("access");return Y.value?(u(),C(o(xe),{key:0,"auto-content-height":""},{default:l(()=>[b(o(V),null,{"toolbar-actions":l(()=>[(u(!0),ge(Ce,null,be(o(p),r=>k((u(),C(o(D),{key:r.id,type:"primary",style:{"margin-right":"12px"},onClick:N=>o(a)(r.bizCode,r.isError,o(h))},{default:l(()=>[B(P(r.label),1)]),_:2},1032,["onClick"])),[[g,[r.auth],"codes"]])),128))]),"toolbar-tools":l(()=>[k((u(),C(o(D),{loading:o(q),class:"mr-2",type:"primary",onClick:n[0]||(n[0]=r=>o($)(o(h),z.value))},{icon:l(()=>[b(o(Q),{class:"mr-1 inline-block size-6"})]),default:l(()=>[n[1]||(n[1]=B(" 导出数据 ",-1))]),_:1},8,["loading"])),[[g,["basic:alipayAccountDetail:export"],"codes"]]),b(o(d))]),natureValue:l(({row:r})=>{var N;return[we("div",null,P(((N=w.value.find(j=>j.value===r.nature))==null?void 0:N.label)||r.nature),1)]}),_:1}),b(o(se),{ref_key:"uploadFormRef",ref:x,"biz-import-type":o(y),extension:o(s),"is-error":o(f),"upload-fn":o(f)?o(ae):o(ie)},null,8,["biz-import-type","extension","is-error","upload-fn"])]),_:1})):(u(),C(o(Ne),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{We as default};
