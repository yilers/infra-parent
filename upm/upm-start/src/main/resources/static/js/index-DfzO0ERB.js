var b=(C,u,s)=>new Promise((c,a)=>{var f=n=>{try{l(s.next(n))}catch(m){a(m)}},p=n=>{try{l(s.throw(n))}catch(m){a(m)}},l=n=>n.done?c(n.value):Promise.resolve(n.value).then(f,p);l((s=s.apply(C,u)).next())});import{dU as V,dV as O}from"./bootstrap-B0IOIL79.js";import{h as B,a as E,b as P}from"./index-arYo5unX.js";import{b as j}from"./params-B2Lywk-4.js";import{c as L,q as M}from"./data-N7aLfSNq.js";import{_ as N}from"./role-assign-drawer.vue_vue_type_script_setup_true_lang-utjdMYVD.js";import{_ as S}from"./role-drawer.vue_vue_type_script_setup_true_lang-B_gdHE1e.js";import{_ as z}from"./role-menu-drawer.vue_vue_type_script_setup_true_lang-BPeZN4uT.js";import{_ as D}from"./table-action.vue_vue_type_style_index_0_lang-D0vDTAOO.js";import{_ as F}from"./table-switch.vue_vue_type_script_setup_true_lang-Bfn17zJi.js";import{_ as G}from"./page.vue_vue_type_script_setup_true_lang-Bz79GSJl.js";import{_ as I}from"./fallback.vue_vue_type_script_setup_true_lang-CK1l9FEq.js";import{m as J,aa as Q,ab as y,b2 as _,bJ as d,j as r,u as e,ac as T}from"../jse/index-index-StHjciy-.js";import{u as g}from"./use-drawer-zBZwZnKb.js";import"./get-popup-container-BlodRF3J.js";import"./index-DOXJoA8u.js";import"./index-DJfT9zXE.js";import"./index-W0ekbP6X.js";import"./Checkbox-Bc2Jc6EI.js";import"./index-CDIraj-f.js";import"./index-DFhZ3N70.js";import"./index-BD1-7l4R.js";import"./useMaxLevel-D3VWO-Yn.js";import"./List-CuvitPlp.js";import"./index-bM1Vk0h0.js";import"./createRef-CUnV3TOs.js";import"./eagerComputed-Be078mV-.js";import"./collapseMotion-BMhP7PaA.js";import"./isSymbol-DB5hLpLo.js";import"./tree-Cp_w0kss.js";import"./uniq-zDniVBSX.js";import"./index-B8AwDIa3.js";import"./index-KxAZzjzc.js";import"./index-Bml6TPTK.js";import"./index-CI0QbcYu.js";import"./shallowequal-OTweHxuM.js";import"./Overflow-2nn19wYT.js";import"./slide-2E_o1wq8.js";import"./Dropdown-C8KFxVx_.js";import"./move-tO33QGmZ.js";import"./index-DL4br4xk.js";import"./rotate-cw-G598-s-f.js";import"./x-eg9hdiEc.js";const Le=J({__name:"index",setup(C){const u={compact:!0,collapsed:!0,commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:M(),submitOnChange:!1,wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},s={columns:L,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(k,...Se)=>b(null,[k,...Se],function*({page:{currentPage:o,pageSize:i}},t={}){const U=j({currentPage:o,pageSize:i},t);return yield P(U)})}},rowConfig:{keyField:"roleId"},id:"system-role-index"},[c,a]=V({formOptions:u,gridOptions:s}),[f,p]=g({connectedComponent:S,destroyOnClose:!0}),[l,n]=g({connectedComponent:z,destroyOnClose:!0}),m=()=>{p.setData({}).open()},$=o=>{p.setData({id:o.id}).open()},w=o=>b(null,null,function*(){yield E(o.id),yield a.query()}),A=o=>{n.setData({id:o.id}).open()},[R,v]=g({connectedComponent:N}),x=o=>{v.setData({id:o.id}).open()},{hasAccessByCodes:h}=O(),q=Q(()=>h(["system:role:list"]));return(o,i)=>q.value?(_(),y(e(G),{key:0,"auto-content-height":!0},{default:d(()=>[r(e(c),null,{"toolbar-actions":d(()=>[r(e(D),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["system:role:add"],onClick:()=>m()}]},null,8,["actions"])]),usable:d(({row:t})=>[r(e(F),{value:t.usable,"onUpdate:value":k=>t.usable=k,api:()=>e(B)(t),onReload:i[0]||(i[0]=k=>e(a).query()),disabled:!e(h)(["system:role:edit"])},null,8,["value","onUpdate:value","api","disabled"])]),action:d(({row:t})=>[t.operable===1?(_(),y(e(D),{key:0,actions:[{label:"编辑",icon:"ant-design:edit-outlined",auth:["system:role:edit"],onClick:$.bind(null,t)},{label:"菜单权限",icon:"ant-design:edit-outlined",auth:["system:role:permission"],onClick:A.bind(null,t)}],"drop-down-actions":[{label:"分配用户",icon:"ant-design:edit-outlined",auth:["system:role:bindUser"],onClick:x.bind(null,t)},{label:"删除",type:"link",icon:"ant-design:delete-outlined",auth:["system:role:delete"],size:"small",popConfirm:{title:"确定删除吗？",confirm:w.bind(null,t)}}]},null,8,["actions","drop-down-actions"])):T("",!0)]),_:1}),r(e(f),{onReload:i[1]||(i[1]=t=>e(a).query())}),r(e(l),{onReload:i[2]||(i[2]=t=>e(a).query())}),r(e(R),{onReload:i[3]||(i[3]=t=>e(a).query())})]),_:1})):(_(),y(e(I),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}});export{Le as default};
