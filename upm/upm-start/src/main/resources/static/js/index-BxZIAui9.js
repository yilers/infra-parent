var j=Object.defineProperty,W=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var _=(t,e,i)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,u=(t,e)=>{for(var i in e||(e={}))U.call(e,i)&&_(t,i,e[i]);if(D)for(var i of D(e))K.call(e,i)&&_(t,i,e[i]);return t},L=(t,e)=>W(t,J(e));var v=(t,e,i)=>new Promise((b,c)=>{var T=r=>{try{l(i.next(r))}catch(m){c(m)}},f=r=>{try{l(i.throw(r))}catch(m){c(m)}},l=r=>r.done?b(r.value):Promise.resolve(r.value).then(T,f);l((i=i.apply(t,e)).next())});import{W as Q}from"./index-C4NAiFfA.js";import{dw as Z,dI as V,dJ as tt,dK as et,dz as ot,a7 as I}from"./bootstrap-DjYyHEgg.js";import{h as it,v as rt}from"./fileTransfer-p8-3apt7.js";import{f as st,B as at}from"./table-FRaKquww.js";import{u as nt,_ as lt}from"./useTableImport-CNd8lRg2.js";import{u as mt}from"./useDownLoad-Cw45s4VH.js";import{u as dt}from"./useDynamicTable-T14ukGXG.js";import{u as ut}from"./useShopCheck-DKIjDUfz.js";import{ci as A,m as pt,b9 as N,v as ct,aa as ft,be as ht,ab as C,b2 as p,bJ as a,j as g,u as o,ae as xt,bp as k,bL as P,ai as B,ad as Ct,I as gt,bb as bt}from"../jse/index-index-rmdNY63r.js";import{p as E}from"./contast-C3bEivmW.js";import{u as Tt}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as St}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as yt}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./pageTableConfig-CJVVeSTk.js";import"./tool-BzPbNkcJ.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:vt}=Tt(),w={toolbarConfig:{resizable:!0},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"id",title:"主键ID",width:180},{field:"commonMerchantOrderNo",title:"订单号"},{field:"commonSupplyOrderNo",title:"供货订单号",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonSupplyProductId",title:"供货商品ID",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonSupplyProductName",title:"供货商品名称",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"xhsAfterSaleNo",title:"售后单号"},{field:"xhsCreateTime",title:"下单时间"},{field:"commonTransactionTime",title:"结算时间"},{field:"commonBusinessType",title:"交易类型"},{field:"xhsSettlementAccount",title:"交易账户"},{field:"xhsMovementAmount",title:"动账金额"},{field:"xhsCommissionBase",title:"计佣基数"},{field:"commonIncomeAmount",title:"商品实付/实退"},{field:"xhsCostAmount",title:"运费实付/实退"},{field:"xhsPlatformSubsidy",title:"平台优惠补贴"},{field:"xhsCostSubsidy",title:"平台运费补贴"},{field:"xhsCrossTax",title:"跨境税代缴"},{field:"xhsProductTax",title:"商品税金"},{field:"xhsCostTax",title:"运费税金"},{field:"xhsCommissionAmount",title:"佣金"},{field:"xhsChannelAmount",title:"支付渠道费"},{field:"xhsSharingCommission",title:"分销佣金"},{field:"xhsOperationCommission",title:"代运营服务商佣金"},{field:"xhsDevelopmentCommission",title:"代开发服务商佣金"},{field:"xhsHuabeiAmount",title:"花呗分期手续费"},{field:"xhsGovAmount",title:"国补订单毛保金额"},{field:"commonProductId",title:"销售商品ID",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonProductName",title:"销售商品名称",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"commonRemark",title:"备注",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"nature",title:"性质",width:270,slots:{default:"natureValue"}},{field:"failedReason",title:"异常原因",formatter({cellValue:t}){return t===null||t===""?"--":t}},{field:"natureStr",title:"性质",width:270},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:t}){const e=E.find(i=>i.value===t);return e?e.label:t}}]},wt={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[vt.datetime("occurTime","发生时间",[A().startOf("month"),A().endOf("month")]),{component:"Input",componentProps:{allowClear:!0},fieldName:"merchantOrderNo",label:"商户订单号"},{component:"Input",componentProps:{allowClear:!0},fieldName:"productName",label:"商品名称"},{component:"Select",componentProps:{allowClear:!0,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6,showSearch:!0,filterOption:(t,e)=>e.label.toLowerCase().includes(t.toLowerCase())},fieldName:"natureList",label:"性质"},{component:"Select",componentProps:{allowClear:!0,options:E,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"}],fieldMappingTime:[["occurTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Jt=pt({__name:"index",setup(t){const{queryWithColumns:e}=dt({staticColumns:w.columns,pageCode:Z.XHSTransactionStatementDetails,queryFn:at}),{checkShopSelected:i}=ut(),{bizImportType:b,bizImportTypeList:c,uploadFormRef:T,isError:f,extension:l,handleImport:r,ImportSettingButton:m}=nt({importTypeList:[{id:1,label:"导入数据",bizCode:"XHS_TRADE_BILL_DETAIL",isError:!1,auth:"basic:xhsTransactionStatementDetails:import"},{id:2,label:"导入异常数据",bizCode:"XHS_TRADE_BILL_DETAIL",isError:!0,auth:"basic:xhsTransactionStatementDetails:importFail"}],defaultExtension:".xls,.xlsx,.csv",errorExtension:".xls,.xlsx,.csv"}),z=N(V.xhsTradeBillDetailCsv),O=u({},wt),F=L(u({},w),{toolbarConfig:u({},w.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1,width:"auto"},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(s,y)=>v(null,[s,y],function*({page:{currentPage:d,pageSize:n}},x){return i()?yield e(h,u({current:d,size:n},x)):{result:{records:[],total:0}}})}}}),H={},[R,h]=tt({gridEvents:H,formOptions:O,gridOptions:F});ct(()=>{M()});const S=N([]),M=()=>v(null,null,function*(){try{const d=yield st({});S.value=d,h.formApi.updateSchema([{componentProps:{options:S.value},fieldName:"natureList"}])}catch(d){et.error("获取性质失败")}}),{handleDownload:X,downLoading:$}=mt(),{hasAccessByCodes:q}=ot(),G=ft(()=>q(["basic:xhsTransactionStatementDetails:list"]));return(d,n)=>{const x=ht("access");return G.value?(p(),C(o(St),{key:0,"auto-content-height":""},{default:a(()=>[g(o(R),null,{"toolbar-actions":a(()=>[(p(!0),Ct(gt,null,bt(o(c),s=>P((p(),C(o(I),{key:s.id,type:"primary",style:{"margin-right":"12px"},onClick:y=>o(r)(s.bizCode,s.isError,o(h))},{default:a(()=>[B(k(s.label),1)]),_:2},1032,["onClick"])),[[x,[s.auth],"codes"]])),128))]),"toolbar-tools":a(()=>[P((p(),C(o(I),{loading:o($),class:"mr-2",type:"primary",onClick:n[0]||(n[0]=s=>o(X)(o(h),z.value))},{icon:a(()=>[g(o(Q),{class:"mr-1 inline-block size-6"})]),default:a(()=>[n[1]||(n[1]=B(" 导出数据 ",-1))]),_:1},8,["loading"])),[[x,["basic:xhsTransactionStatementDetails:export"],"codes"]]),g(o(m))]),natureValue:a(({row:s})=>{var y;return[xt("div",null,k(((y=S.value.find(Y=>Y.value===s.nature))==null?void 0:y.label)||s.nature),1)]}),_:1}),g(o(lt),{ref_key:"uploadFormRef",ref:T,"biz-import-type":o(b),extension:o(l),"is-error":o(f),"upload-fn":o(f)?o(rt):o(it)},null,8,["biz-import-type","extension","is-error","upload-fn"])]),_:1})):(p(),C(o(yt),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Jt as default};
