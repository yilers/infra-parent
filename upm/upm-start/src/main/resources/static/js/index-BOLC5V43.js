var b=(C,u,i)=>new Promise((c,s)=>{var f=a=>{try{l(i.next(a))}catch(m){s(m)}},d=a=>{try{l(i.throw(a))}catch(m){s(m)}},l=a=>a.done?c(a.value):Promise.resolve(a.value).then(f,d);l((i=i.apply(C,u)).next())});import{ee as U,dz as V}from"./bootstrap-DjYyHEgg.js";import{h as B,a as E,b as P}from"./index-DphJOICZ.js";import{b as j}from"./params-B2Lywk-4.js";import{c as z,q as L}from"./data-I_kBbuuX.js";import{_ as M}from"./role-assign-drawer.vue_vue_type_script_setup_true_lang-Bdat5AzW.js";import{_ as N}from"./role-drawer.vue_vue_type_script_setup_true_lang-BM9QhJ94.js";import{_ as S}from"./role-menu-drawer.vue_vue_type_script_setup_true_lang-COPy_Rrd.js";import{_ as D}from"./table-action.vue_vue_type_style_index_0_lang-BluPqhNI.js";import{_ as F}from"./table-switch.vue_vue_type_script_setup_true_lang-B507ijfF.js";import{_ as G}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as I}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import{m as J,aa as Q,ab as y,b2 as _,bJ as p,j as r,u as e,ac as T}from"../jse/index-index-rmdNY63r.js";import{u as g}from"./use-drawer-CB92zaEG.js";import"./get-popup-container-BlodRF3J.js";import"./index-ZCUElbZQ.js";import"./index-D5n-88Z9.js";import"./index-xNzK-YmT.js";import"./Checkbox-CqCSSW-K.js";import"./index-BV3wPNbt.js";import"./isSymbol-BoOBgcZb.js";import"./tree-DTIvVT2i.js";import"./uniq-B9t2APT2.js";import"./index-BMGH9Kr9.js";import"./index-DpFkAyCC.js";import"./menu-select-table-RWiO7UhU.js";import"./index-CM6A-82x.js";import"./index-Bw6N7aDv.js";import"./shallowequal-W2RnI4nT.js";import"./Dropdown-D1vLSWoc.js";import"./index-D8FOz6S4.js";import"./rotate-cw-Dzdn7gja.js";const Re=J({__name:"index",setup(C){const u={compact:!0,collapsed:!0,commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:L(),submitOnChange:!1,wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},i={columns:z,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(k,...qe)=>b(null,[k,...qe],function*({page:{currentPage:o,pageSize:n}},t={}){const O=j({currentPage:o,pageSize:n},t);return yield P(O)})}},rowConfig:{keyField:"roleId"},id:"system-role-index"},[c,s]=U({formOptions:u,gridOptions:i}),[f,d]=g({connectedComponent:N,destroyOnClose:!0}),[l,a]=g({connectedComponent:S,destroyOnClose:!0}),m=()=>{d.setData({}).open()},$=o=>{d.setData({id:o.id}).open()},w=o=>b(null,null,function*(){yield E(o.id),yield s.query()}),A=o=>{a.setData({id:o.id}).open()},[R,v]=g({connectedComponent:M}),x=o=>{v.setData({id:o.id}).open()},{hasAccessByCodes:h}=V(),q=Q(()=>h(["system:role:list"]));return(o,n)=>q.value?(_(),y(e(G),{key:0,"auto-content-height":!0},{default:p(()=>[r(e(c),null,{"toolbar-actions":p(()=>[r(e(D),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["system:role:add"],onClick:()=>m()}]},null,8,["actions"])]),usable:p(({row:t})=>[r(e(F),{value:t.usable,"onUpdate:value":k=>t.usable=k,api:()=>e(B)(t),onReload:n[0]||(n[0]=k=>e(s).query()),disabled:!e(h)(["system:role:edit"])},null,8,["value","onUpdate:value","api","disabled"])]),action:p(({row:t})=>[t.operable===1?(_(),y(e(D),{key:0,actions:[{label:"编辑",icon:"ant-design:edit-outlined",auth:["system:role:edit"],onClick:$.bind(null,t)},{label:"菜单权限",icon:"ant-design:edit-outlined",auth:["system:role:permission"],onClick:A.bind(null,t)}],"drop-down-actions":[{label:"分配用户",icon:"ant-design:edit-outlined",auth:["system:role:bindUser"],onClick:x.bind(null,t)},{label:"删除",type:"link",icon:"ant-design:delete-outlined",auth:["system:role:delete"],size:"small",popConfirm:{title:"确定删除吗？",confirm:w.bind(null,t)}}]},null,8,["actions","drop-down-actions"])):T("",!0)]),_:1}),r(e(f),{onReload:n[1]||(n[1]=t=>e(s).query())}),r(e(l),{onReload:n[2]||(n[2]=t=>e(s).query())}),r(e(R),{onReload:n[3]||(n[3]=t=>e(s).query())})]),_:1})):(_(),y(e(I),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}});export{Re as default};
