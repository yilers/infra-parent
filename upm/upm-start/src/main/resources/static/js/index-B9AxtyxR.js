var F=Object.defineProperty,Y=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var _=(i,e,t)=>e in i?F(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,d=(i,e)=>{for(var t in e||(e={}))j.call(e,t)&&_(i,t,e[t]);if(v)for(var t of v(e))H.call(e,t)&&_(i,t,e[t]);return i},x=(i,e)=>Y(i,$(e));var k=(i,e,t)=>new Promise((h,m)=>{var g=r=>{try{l(t.next(r))}catch(c){m(c)}},C=r=>{try{l(t.throw(r))}catch(c){m(c)}},l=r=>r.done?h(r.value):Promise.resolve(r.value).then(g,C);l((t=t.apply(i,e)).next())});import{W as R}from"./index-C4NAiFfA.js";import{dI as V,dJ as G,dz as J,a7 as D}from"./bootstrap-DjYyHEgg.js";import{h as M}from"./fileTransfer-p8-3apt7.js";import{k as q}from"./table-FRaKquww.js";import{u as W,_ as U}from"./useTableImport-CNd8lRg2.js";import{u as K}from"./useDownLoad-Cw45s4VH.js";import{u as Q}from"./useShopCheck-DKIjDUfz.js";import{ci as I,m as X,b9 as Z,aa as ee,be as te,ab as f,b2 as p,bJ as n,j as b,u as o,bL as T,ai as z,ad as oe,I as ie,bb as re,bp as ae}from"../jse/index-index-rmdNY63r.js";import{p as se}from"./contast-C3bEivmW.js";import{u as ne}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as le}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as ce}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:de}=ne(),P={toolbarConfig:{resizable:!0},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"type",title:"类型",width:130},{field:"alipayTradeNo",title:"支付宝交易流水号",width:240},{field:"merchantOrderNo",title:"商家订单号",width:240},{field:"productName",title:"商品名称",width:460},{field:"orderAmount",title:"订单金额（元）",width:150},{field:"deductionAmount",title:"抵扣金额（元）",width:150},{field:"transactionTime",title:"业务发生时间",width:160},{field:"receiverAccount",title:"收款账户",width:240},{field:"payerAccount",title:"付款账户",width:240},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:i}){const e=se.find(t=>t.value===i);return e?e.label:i}},{field:"createTime",title:"创建时间",width:160}]},pe={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Select",componentProps:{allowClear:!0,options:[{label:"集分宝",value:"集分宝"},{label:"惠营宝",value:"惠营宝"}],placeholder:"请选择"},fieldName:"type",label:"类型"},de.datetime("transactionTime","业务发生时间",[I().startOf("month"),I().endOf("month")]),{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"alipayTradeNo",label:"交易流水号"}],fieldMappingTime:[["transactionTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Be=X({__name:"index",setup(i){const{checkShopSelected:e}=Q(),{bizImportType:t,bizImportTypeList:h,uploadFormRef:m,handleImport:g,extension:C,ImportSettingButton:l}=W({importTypeList:[{id:1,label:"集分宝导入数据",bizCode:"ALI_JFB",isError:!1,auth:"basic:invoicePointsDetail:jifenbaoImport"},{id:2,label:"惠营宝导入数据",bizCode:"ALI_HYB",isError:!1,auth:"basic:invoicePointsDetail:huiyingbaoImport"}],defaultExtension:".csv"}),r=Z(V.alipayInvoiceDetailCsv),c=d({},pe),S=x(d({},P),{toolbarConfig:d({},P.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(s,me)=>k(null,[s,me],function*({page:{currentPage:w,pageSize:a}},u){return e()?yield q(d({current:w,size:a},u)):{result:{records:[],total:0}}})}}}),L={},[A,y]=G({gridEvents:L,formOptions:c,gridOptions:S}),{handleDownload:B,downLoading:N}=K(),{hasAccessByCodes:O}=J(),E=ee(()=>O(["basic:invoicePointsDetail:list"]));return(w,a)=>{const u=te("access");return E.value?(p(),f(o(le),{key:0,"auto-content-height":""},{default:n(()=>[b(o(A),null,{"toolbar-actions":n(()=>[(p(!0),oe(ie,null,re(o(h),s=>T((p(),f(o(D),{key:s.id,type:"primary",style:{"margin-right":"12px"},onClick:me=>o(g)(s.bizCode,s.isError,o(y))},{default:n(()=>[z(ae(s.label),1)]),_:2},1032,["onClick"])),[[u,[s.auth],"codes"]])),128))]),"toolbar-tools":n(()=>[T((p(),f(o(D),{loading:o(N),class:"mr-2",type:"primary",onClick:a[0]||(a[0]=s=>o(B)(o(y),r.value))},{icon:n(()=>[b(o(R),{class:"mr-1 inline-block size-6"})]),default:n(()=>[a[1]||(a[1]=z(" 导出数据 ",-1))]),_:1},8,["loading"])),[[u,["basic:invoicePointsDetail:export"],"codes"]]),b(o(l))]),_:1}),b(o(U),{ref_key:"uploadFormRef",ref:m,"biz-import-type":o(t),"upload-fn":o(M),extension:o(C)},null,8,["biz-import-type","upload-fn","extension"])]),_:1})):(p(),f(o(ce),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Be as default};
