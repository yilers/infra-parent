var H=Object.defineProperty,V=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var _=(t,e,o)=>e in t?H(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,u=(t,e)=>{for(var o in e||(e={}))U.call(e,o)&&_(t,o,e[o]);if(v)for(var o of v(e))K.call(e,o)&&_(t,o,e[o]);return t},L=(t,e)=>V(t,J(e));var D=(t,e,o)=>new Promise((g,p)=>{var C=r=>{try{d(o.next(r))}catch(n){p(n)}},f=r=>{try{d(o.throw(r))}catch(n){p(n)}},d=r=>r.done?g(r.value):Promise.resolve(r.value).then(C,f);d((o=o.apply(t,e)).next())});import{W as Q}from"./index-C4NAiFfA.js";import{dw as X,dI as Z,dJ as tt,dK as et,dz as it,a7 as I}from"./bootstrap-DjYyHEgg.js";import{h as ot,p as rt}from"./fileTransfer-p8-3apt7.js";import{f as at,t as st}from"./table-FRaKquww.js";import{u as lt,_ as dt}from"./useTableImport-CNd8lRg2.js";import{u as nt}from"./useDownLoad-Cw45s4VH.js";import{u as mt}from"./useDynamicTable-T14ukGXG.js";import{u as ut}from"./useShopCheck-DKIjDUfz.js";import{ci as A,m as ct,b9 as B,v as pt,aa as ft,be as ht,ab as w,b2 as c,bJ as s,j as b,u as i,ae as yt,bp as P,bL as k,ai as E,ad as wt,I as bt,bb as gt}from"../jse/index-index-rmdNY63r.js";import{p as O}from"./contast-C3bEivmW.js";import{u as Ct}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as Tt}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as St}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./pageTableConfig-CJVVeSTk.js";import"./tool-BzPbNkcJ.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:Dt}=Ct(),x={toolbarConfig:{custom:!0,export:!1,refresh:!0,resizable:!0,zoom:!0,search:!1},columns:[{field:"id",title:"主键ID",width:180},{field:"commonTransactionTime",title:"动账时间",width:150},{field:"commonPayTradeNo",title:"动帐流水号",width:180},{field:"commonBusinessType",title:"动账方向",width:150},{field:"dyMovementAmount",title:"动账金额",width:150},{field:"dyMovementAccount",title:"动账账户",width:150},{field:"commonBusinessDescription",title:"动账场景",width:150},{field:"dyBillType",title:"计费类型",width:150},{field:"commonOrderNo",title:"子订单号",width:180},{field:"commonMerchantOrderNo",title:"订单号",width:180},{field:"dyAfterSaleNo",title:"售后编号",width:180},{field:"dyCreateTime",title:"下单时间",width:150},{field:"commonProductId",title:"商品ID",width:150},{field:"commonProductName",title:"商品名称",width:180},{field:"dyExpertId",title:"达人ID",width:150},{field:"dyExpertName",title:"达人名称",width:150},{field:"dyOrderType",title:"订单类型",width:150},{field:"dyOrderDue",title:"订单实付应结",width:150},{field:"dyCostDue",title:"运费实付",width:150},{field:"dyCostSubsidy",title:"实际平台补贴_运费",width:150},{field:"dyPlatformSubsidy",title:"实际平台补贴",width:150},{field:"dyOtherSubsidy",title:"其他平台补贴",width:150},{field:"dyGovSubsidy",title:"政府补贴平台垫资",width:150},{field:"dyExpertSubsidy",title:"实际达人补贴",width:150},{field:"dyPaySubsidy",title:"实际抖音支付补贴",width:150},{field:"dyMonthPaySubsidy",title:"实际抖音月付营销补贴",width:180},{field:"dyBankSubsidy",title:"银行补贴",width:150},{field:"dyOrderRefund",title:"订单退款",width:150},{field:"dyServiceAmount",title:"平台服务费",width:150},{field:"dyCommissionAmount",title:"佣金",width:150},{field:"dyProviderCommission",title:"服务商佣金",width:150},{field:"dyChannelSharing",title:"渠道分成",width:150},{field:"dyBusinessServiceAmount",title:"招商服务费",width:150},{field:"dyOutPromotionAmount",title:"站外推广费",width:150},{field:"dyOtherSharing",title:"其他分成",width:150},{field:"dyIsWaived",title:"是否免佣",width:150},{field:"dyWaivedAmount",title:"免佣金额",width:150},{field:"commonRemark",title:"备注",width:180,formatter({cellValue:t}){return t===null?"--":t}},{field:"commonSupplyOrderNo",title:"供货订单号",width:150},{field:"commonSupplyProductName",title:"供货商品名称",width:150},{field:"commonSupplyProductId",title:"供货商品ID",width:150},{field:"commonIncomeAmount",title:"总金额",width:150},{field:"nature",title:"性质",width:270,slots:{default:"natureValue"}},{field:"natureStr",title:"性质",width:240,formatter({cellValue:t}){return t===null?"--":t}},{field:"failedReason",title:"异常原因",width:240,formatter({cellValue:t}){return t===null?"--":t}},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:t}){const e=O.find(o=>o.value===t);return e?e.label:t}}]},xt={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[Dt.datetime("commonTransactionTime","动账时间",[A().startOf("month"),A().endOf("month")]),{component:"Select",componentProps:{allowClear:!0,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6,showSearch:!0,filterOption:(t,e)=>e.label.toLowerCase().includes(t.toLowerCase())},fieldName:"natureList",label:"性质"},{component:"Select",componentProps:{allowClear:!0,options:O,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"}],fieldMappingTime:[["commonTransactionTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},Jt=ct({__name:"index",setup(t){const{checkShopSelected:e}=ut(),{queryWithColumns:o}=mt({staticColumns:x.columns,pageCode:X.DYTransactionStatementDetails,queryFn:st}),{bizImportType:g,bizImportTypeList:p,uploadFormRef:C,isError:f,extension:d,handleImport:r,ImportSettingButton:n}=lt({importTypeList:[{id:1,label:"导入数据",bizCode:"DY_TRADE_BILL_DETAIL",isError:!1,auth:"basic:dyTransactionStatementDetails:import"},{id:2,label:"导入异常数据",bizCode:"DY_TRADE_BILL_DETAIL",isError:!0,auth:"basic:dyTransactionStatementDetails:importFail"}],defaultExtension:".csv,.xlsx,.xls",errorExtension:".xlsx"}),N=B(Z.dyTradeBillDetailCsv),z=u({},xt),F=L(u({},x),{toolbarConfig:u({},x.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(a,S)=>D(null,[a,S],function*({page:{currentPage:m,pageSize:l}},y){return e()?yield o(h,u({current:m,size:l},y)):{result:{records:[],total:0}}})}}}),R={},[M,h]=tt({gridEvents:R,formOptions:z,gridOptions:F});pt(()=>{Y()});const T=B([]),Y=()=>D(null,null,function*(){try{const m=yield at({});T.value=m,h.formApi.updateSchema([{componentProps:{options:T.value},fieldName:"natureList"}])}catch(m){et.error("获取性质失败")}}),{handleDownload:W,downLoading:$}=nt(),{hasAccessByCodes:j}=it(),q=ft(()=>j(["basic:dyTransactionStatementDetails:list"]));return(m,l)=>{const y=ht("access");return q.value?(c(),w(i(Tt),{key:0,"auto-content-height":""},{default:s(()=>[b(i(M),null,{"toolbar-actions":s(()=>[(c(!0),wt(bt,null,gt(i(p),a=>k((c(),w(i(I),{key:a.id,type:"primary",style:{"margin-right":"12px"},onClick:S=>i(r)(a.bizCode,a.isError,i(h))},{default:s(()=>[E(P(a.label),1)]),_:2},1032,["onClick"])),[[y,[a.auth],"codes"]])),128))]),"toolbar-tools":s(()=>[k((c(),w(i(I),{loading:i($),class:"mr-2",type:"primary",onClick:l[0]||(l[0]=a=>i(W)(i(h),N.value))},{icon:s(()=>[b(i(Q),{class:"mr-1 inline-block size-6"})]),default:s(()=>[l[1]||(l[1]=E(" 导出数据 ",-1))]),_:1},8,["loading"])),[[y,["basic:dyTransactionStatementDetails:export"],"codes"]]),b(i(n))]),natureValue:s(({row:a})=>{var S;return[yt("div",null,P(((S=T.value.find(G=>G.value===a.nature))==null?void 0:S.label)||a.nature),1)]}),_:1}),b(i(dt),{ref_key:"uploadFormRef",ref:C,"biz-import-type":i(g),"is-error":i(f),"upload-fn":i(f)?i(rt):i(ot),extension:i(d)},null,8,["biz-import-type","is-error","upload-fn","extension"])]),_:1})):(c(),w(i(St),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{Jt as default};
