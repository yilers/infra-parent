var j=Object.defineProperty,N=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var D=(t,e,a)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,I=(t,e)=>{for(var a in e||(e={}))R.call(e,a)&&D(t,a,e[a]);if(_)for(var a of _(e))G.call(e,a)&&D(t,a,e[a]);return t},E=(t,e)=>N(t,L(e));var S=(t,e,a)=>new Promise((n,s)=>{var u=o=>{try{i(a.next(o))}catch(m){s(m)}},v=o=>{try{i(a.throw(o))}catch(m){s(m)}},i=o=>o.done?n(o.value):Promise.resolve(o.value).then(u,v);i((a=a.apply(t,e)).next())});import{b as K}from"./index-D5n-88Z9.js";import{InputSearch as U}from"./index-EkdSFYQU.js";import{I as q,a7 as F,em as B}from"./bootstrap-DjYyHEgg.js";import{j as f,m as J,aP as P,bz as C,b9 as y,v as Q,ad as h,b2 as p,bJ as g,ae as x,ac as H,u as d,ab as W,aQ as X,ai as M,bp as b,aR as Y}from"../jse/index-index-rmdNY63r.js";import{S as Z}from"./index-D_3miOiz.js";import{g as ee,s as ae,l as te,c as se}from"./tree-DTIvVT2i.js";import{T as le}from"./index-BV3wPNbt.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function T(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?Object(arguments[e]):{},n=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable}))),n.forEach(function(s){ne(t,s,a[s])})}return t}function ne(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var k=function(e,a){var n=T({},e,a.attrs);return f(q,T({},n,{icon:re}),null)};k.displayName="SyncOutlined";k.inheritAttrs=!1;const oe={class:"bg-background flex h-full flex-col overflow-y-auto rounded-lg"},ce={key:0,class:"bg-background z-100 sticky left-0 top-0 p-[8px]"},ie={class:"h-full overflow-x-hidden px-[8px]"},ue={key:0},de={class:"text-primary"},pe={key:1},fe={key:1,class:"mt-5"},ke=J({inheritAttrs:!1,__name:"dept-tree",props:P({showSearch:{type:Boolean,default:!0}},{selectDeptId:{required:!0,type:Array},selectDeptIdModifiers:{},searchValue:{type:String,default:""},searchValueModifiers:{}}),emits:P(["reload","select"],["update:selectDeptId","update:searchValue"]),setup(t,{emit:e}){const a=e,n=C(t,"selectDeptId"),s=C(t,"searchValue"),u=y([]),v=y(!0),i=y([]),o=y(!0);function m(l){const c=l.map(w=>E(I({},w),{disabled:w.usable===0})),r=ae(c,"sortNumber","id");return te(r,{id:"id",pid:"parentId"})}function O(){return S(this,null,function*(){v.value=!0,s.value="",n.value=[];try{const l=yield K({});u.value=m(l),i.value=ee(u.value,{id:"id",children:"children"})}catch(l){console.error("加载部门树失败",l)}finally{v.value=!1}})}function V(){return S(this,null,function*(){yield O(),a("reload")})}const A=l=>{i.value=se(l,u.value,{id:"id",children:"children",title:"deptName"}),o.value=!0},$=l=>{const c=l.target.value.trim();s.value=c,A(c)},z=l=>{i.value=l,o.value=!1};return Q(O),(l,c)=>(p(),h("div",{class:Y(l.$attrs.class)},[f(d(Z),{loading:v.value,paragraph:{rows:8},active:"",class:"p-[8px]"},{default:g(()=>[x("div",oe,[t.showSearch?(p(),h("div",ce,[f(d(U),{value:s.value,"onUpdate:value":c[0]||(c[0]=r=>s.value=r),placeholder:l.$t("pages.common.search"),size:"small",onChange:$},{enterButton:g(()=>[f(d(F),{onClick:V},{default:g(()=>[f(d(k),{class:"text-primary"})]),_:1})]),_:1},8,["value","placeholder"])])):H("",!0),x("div",ie,[u.value.length>0?(p(),W(d(le),X({key:0},l.$attrs,{"selected-keys":n.value,"onUpdate:selectedKeys":c[1]||(c[1]=r=>n.value=r),class:l.$attrs.class,"field-names":{title:"deptName",key:"id"},"show-line":{showLeafIcon:!1},"tree-data":u.value,virtual:!1,"expanded-keys":i.value,"auto-expand-parent":o.value,onSelect:c[2]||(c[2]=r=>l.$emit("select")),onExpand:z}),{title:g(({deptName:r})=>[r.includes(s.value)&&s.value?(p(),h("span",ue,[M(b(r.substring(0,r.indexOf(s.value)))+" ",1),x("span",de,b(s.value),1),M(" "+b(r.substring(r.indexOf(s.value)+s.value.length)),1)])):(p(),h("span",pe,b(r),1))]),_:1},16,["selected-keys","class","tree-data","expanded-keys","auto-expand-parent"])):(p(),h("div",fe,[f(d(B),{image:d(B).PRESENTED_IMAGE_SIMPLE,description:"无部门数据"},null,8,["image"])]))])])]),_:1},8,["loading"])],2))}});export{ke as _};
