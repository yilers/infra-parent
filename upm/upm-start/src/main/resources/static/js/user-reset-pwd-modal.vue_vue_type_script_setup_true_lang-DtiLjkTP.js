var c=(f,d,s)=>new Promise((u,o)=>{var m=a=>{try{e(s.next(a))}catch(l){o(l)}},t=a=>{try{e(s.throw(a))}catch(l){o(l)}},e=a=>a.done?u(a.value):Promise.resolve(a.value).then(m,t);e((s=s.apply(f,d)).next())});import{cX as I,b5 as _}from"./bootstrap-B0IOIL79.js";import{h as C}from"./index-DOXJoA8u.js";import{m as k,b9 as A,ab as L,b2 as N,bJ as V,j as x,u as w}from"../jse/index-index-StHjciy-.js";import{u as B}from"./use-modal-RS0jGB5k.js";import{m as F}from"./crypto-BIPOTUv7.js";const j=k({__name:"user-reset-pwd-modal",emits:["reload"],setup(f,{emit:d}){const s=d,[u,o]=B({onClosed:v,onConfirm:l,onOpenChange:a,destroyOnClose:!0}),[m,t]=I({schema:[{component:"Input",dependencies:{show:()=>!1,triggerFields:[""]},fieldName:"id",label:"用户ID",rules:"required",disabled:!0},{component:"Input",fieldName:"account",label:"用户账号",rules:"required",disabled:!0},{component:"Input",fieldName:"nickname",label:"用户昵称",rules:"required",disabled:!0},{component:"InputPassword",componentProps:{placeholder:"请输入新的密码, 密码长度为5 - 20"},fieldName:"password",label:"新的密码",rules:_().min(5,{message:"密码长度为5 - 20"}).max(20,{message:"密码长度为5 - 20"})}],showDefaultActions:!1,commonConfig:{labelWidth:80}}),e=A(null);function a(n){return c(this,null,function*(){if(!n)return null;const r=o.getData();r.password="",e.value=r,e.value.roleIdList=Array.isArray(e.value.roleList)?e.value.roleList.map(i=>i.id):[],yield t.setValues(e.value)})}function l(){return c(this,null,function*(){var n,r,i,b,h;o.lock(!0);try{const{valid:p}=yield t.validate();if(!p)return;const g=yield t.getValues(),y={id:(n=e.value)==null?void 0:n.id,password:F(g.password),account:(r=e.value)==null?void 0:r.account,nickname:(i=e.value)==null?void 0:i.nickname,deptId:(b=e.value)==null?void 0:b.deptId,roleIdList:(h=e.value)==null?void 0:h.roleIdList};yield C(y),s("reload"),o.close()}catch(p){console.error(p)}finally{o.lock(!1)}})}function v(){return c(this,null,function*(){o.close(),yield t.resetForm(),e.value=null})}return(n,r)=>(N(),L(w(u),{"close-on-click-modal":!1,"fullscreen-button":!1,title:"重置密码"},{default:V(()=>[x(w(m))]),_:1}))}});export{j as _};
