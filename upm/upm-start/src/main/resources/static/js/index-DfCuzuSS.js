var F=Object.defineProperty,N=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var x=(o,t,e)=>t in o?F(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,d=(o,t)=>{for(var e in t||(t={}))B.call(t,e)&&x(o,e,t[e]);if(M)for(var e of M(t))E.call(t,e)&&x(o,e,t[e]);return o},h=(o,t)=>N(o,j(t));var b=(o,t,e)=>new Promise((n,m)=>{var C=r=>{try{l(e.next(r))}catch(p){m(p)}},_=r=>{try{l(e.throw(r))}catch(p){m(p)}},l=r=>r.done?n(r.value):Promise.resolve(r.value).then(C,_);l((e=e.apply(o,t)).next())});import{dJ as J,dK as w}from"./bootstrap-DjYyHEgg.js";import{c as R,d as U,h as q}from"./productMatch-mIhL3Voh.js";import{u as H}from"./useShopCheck-DKIjDUfz.js";import{g as S,s as I,_ as K}from"./form.vue_vue_type_script_setup_true_lang-CswopdsE.js";import{_ as P}from"./table-action.vue_vue_type_style_index_0_lang-BluPqhNI.js";import{u as L,_ as Q}from"./permission-tabs.vue_vue_type_script_setup_true_lang-CReN1h6G.js";import{_ as W}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as X}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import{m as Y,b9 as A,v as Z,ab as y,u as a,b2 as k,bJ as u,ac as ee,j as g,n as te}from"../jse/index-index-rmdNY63r.js";import"./useDateRangePicker-DjB1zMnJ.js";import"./index-Bw6N7aDv.js";import"./shallowequal-W2RnI4nT.js";import"./index-CM6A-82x.js";import"./Dropdown-D1vLSWoc.js";import"./index-wrrfkh6D.js";import"./useRefs-ReJqRy3L.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./rotate-cw-Dzdn7gja.js";const Te=Y({__name:"index",setup(o){const{checkShopSelected:t}=H(),e=A([]),n=A(),m=h(d({},I),{collapsed:!0}),C=h(d({},S),{toolbarConfig:d({},S.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!1,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(we,Se)=>b(null,[we,Se],function*({page:{currentPage:s,pageSize:i}},f){return t()?yield R(h(d({current:s,size:i},f),{type:a(c)})):{result:{records:[],total:0}}})}}}),_={},[l,r]=J({gridEvents:_,formOptions:m,gridOptions:C}),p=()=>{t()&&(n.value.setData({isUpdate:!1,activeTab:a(c),gridApi:r,categories:a(e)}),n.value.open())},$=s=>{n.value.setData({record:s,isUpdate:!0,activeTab:a(c),gridApi:r,categories:a(e)}),n.value.open()},D=s=>b(null,null,function*(){yield U(s.id),w.success("删除成功"),r.reload()}),v=()=>{r.formApi.updateSchema([{fieldName:"cardIds",componentProps:{options:e.value}}])},G=()=>b(null,null,function*(){try{const s=yield q();e.value=s.map(i=>({label:i.name,value:i.id})),v()}catch(s){w.error("获取分类失败")}});Z(()=>{t()&&G()});const T=[{key:2,label:"供货后台商品",permissions:["template:productCardTypeMatch:tencent"]},{key:1,label:"销售后台商品",permissions:["template:productCardTypeMatch:tMall"]}],{activeTab:c,accessibleTabs:O,handleTabChange:V}=L(T),z=s=>{V(s),te(()=>v())};return(s,i)=>a(O).length>0?(k(),y(a(W),{key:0,"auto-content-height":"","header-class":"pb-0"},{description:u(()=>[g(a(Q),{configs:T,onChange:z})]),default:u(()=>[a(c)===1||a(c)===2?(k(),y(a(l),{key:a(c)},{"toolbar-actions":u(()=>[g(a(P),{actions:[{label:"新增商品",type:"primary",icon:"ant-design:plus-outlined",auth:["template:productCardTypeMatch:add"],onClick:p.bind(null)}]},null,8,["actions"])]),"toolbar-tools":u(()=>[...i[0]||(i[0]=[])]),action:u(({row:f})=>[g(a(P),{actions:[{label:"编辑",icon:"ant-design:edit-outlined",type:"link",size:"small",auth:["template:productCardTypeMatch:edit"],onClick:$.bind(null,f)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",auth:["template:productCardTypeMatch:delete"],popConfirm:{title:"确定删除吗？",confirm:D.bind(null,f)}}]},null,8,["actions","drop-down-actions"])]),_:1})):ee("",!0),g(K,{ref_key:"productMatchFormRef",ref:n},null,512)]),_:1})):(k(),y(a(X),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}});export{Te as default};
