var j=Object.defineProperty,q=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var L=(a,e,o)=>e in a?j(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,p=(a,e)=>{for(var o in e||(e={}))J.call(e,o)&&L(a,o,e[o]);if(v)for(var o of v(e))U.call(e,o)&&L(a,o,e[o]);return a},D=(a,e)=>q(a,G(e));var _=(a,e,o)=>new Promise((w,u)=>{var f=i=>{try{l(o.next(i))}catch(m){u(m)}},C=i=>{try{l(o.throw(i))}catch(m){u(m)}},l=i=>i.done?w(i.value):Promise.resolve(i.value).then(f,C);l((o=o.apply(a,e)).next())});import{W as K}from"./index-C4NAiFfA.js";import{dI as Q,dJ as X,dK as Z,dz as ee,a7 as E}from"./bootstrap-DjYyHEgg.js";import{h as te,t as oe}from"./fileTransfer-p8-3apt7.js";import{f as ae,z as ie}from"./table-FRaKquww.js";import{u as re,_ as se}from"./useTableImport-CNd8lRg2.js";import{u as ne}from"./useDownLoad-Cw45s4VH.js";import{u as le}from"./useShopCheck-DKIjDUfz.js";import{ci as N,m as me,b9 as k,v as ce,aa as pe,be as de,ab as g,b2 as d,bJ as s,j as b,u as t,ae as ue,bp as P,bL as S,ai as B,ad as fe,I as he,bb as ge}from"../jse/index-index-rmdNY63r.js";import{p as A}from"./contast-C3bEivmW.js";import{u as be}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as we}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as Ce}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:xe}=be(),z={toolbarConfig:{resizable:!0},columns:[{title:"序号",type:"seq",width:50,fixed:"left"},{field:"commonTransactionTime",title:"入账时间",width:150},{field:"commonPayTradeNo",title:"支付流水号",width:200},{field:"nature",title:"性质",width:270,slots:{default:"natureValue"}},{field:"commonOrderNo",title:"淘宝订单编号",width:200},{field:"commonProductName",title:"商品名称",width:420},{field:"commonBusinessType",title:"入账类型",width:200},{field:"commonIncomeAmount",title:"收入金额（元）",width:150},{field:"commonExpenseAmount",title:"支出金额（元）",width:150},{field:"commonBusinessDescription",title:"业务描述",width:380},{field:"commonRemark",title:"备注",width:380},{field:"progressStatus",title:"进度状态",width:150,formatter({cellValue:a}){const e=A.find(o=>o.value===a);return e?e.label:a}},{field:"createTime",title:"创建时间",width:160}]},ye={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[xe.datetime("paymentTime","入账时间",[N().startOf("month"),N().endOf("month")]),{component:"Select",componentProps:{allowClear:!0,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6,showSearch:!0,filterOption:(a,e)=>e.label.toLowerCase().includes(a.toLowerCase())},fieldName:"natureList",label:"性质"},{component:"Select",componentProps:{allowClear:!0,options:A,placeholder:"请选择",mode:"multiple",maxTagCount:1,maxTagTextLength:6},fieldName:"progressStatusList",label:"进度状态"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"productName",label:"商品名称"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"orderNo",label:"订单编号"}],fieldMappingTime:[["paymentTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},He=me({__name:"index",setup(a){const{checkShopSelected:e}=le(),{bizImportType:o,bizImportTypeList:w,uploadFormRef:u,isError:f,extension:C,handleImport:l,ImportSettingButton:i}=re({importTypeList:[{id:1,label:"导入数据",bizCode:"WECHAT_PAYMENT_DETAIL",isError:!1,auth:"basic:wechatBillingDetails:import"},{id:2,label:"导入异常数据",bizCode:"WECHAT_PAYMENT_DETAIL",isError:!0,auth:"basic:wechatBillingDetails:importFail"}],defaultExtension:".xls,.xlsx,.csv",errorExtension:".xls,.xlsx,.csv"}),m=k(Q.wechatPaymentDetailCsv),I=p({},ye),F=D(p({},z),{toolbarConfig:p({},z.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(r,T)=>_(null,[r,T],function*({page:{currentPage:c,pageSize:n}},h){return e()?yield ie(p({current:c,size:n},h)):{result:{records:[],total:0}}})}}}),O={},[V,x]=X({gridEvents:O,formOptions:I,gridOptions:F});ce(()=>{M()});const y=k([]),M=()=>_(null,null,function*(){try{const c=yield ae({});y.value=c,x.formApi.updateSchema([{componentProps:{options:y.value},fieldName:"natureList"}])}catch(c){Z.error("获取性质失败")}}),{handleDownload:W,downLoading:Y}=ne(),{hasAccessByCodes:H}=ee(),R=pe(()=>H(["basic:wechatBillingDetails:list"]));return(c,n)=>{const h=de("access");return R.value?(d(),g(t(we),{key:0,"auto-content-height":""},{default:s(()=>[b(t(V),null,{"toolbar-actions":s(()=>[(d(!0),fe(he,null,ge(t(w),r=>S((d(),g(t(E),{key:r.id,type:"primary",style:{"margin-right":"12px"},onClick:T=>t(l)(r.bizCode,r.isError,t(x))},{default:s(()=>[B(P(r.label),1)]),_:2},1032,["onClick"])),[[h,[r.auth],"codes"]])),128))]),"toolbar-tools":s(()=>[S((d(),g(t(E),{loading:t(Y),class:"mr-2",type:"primary",onClick:n[0]||(n[0]=r=>t(W)(t(x),m.value))},{icon:s(()=>[b(t(K),{class:"mr-1 inline-block size-6"})]),default:s(()=>[n[1]||(n[1]=B(" 导出数据 ",-1))]),_:1},8,["loading"])),[[h,["basic:wechatBillingDetails:export"],"codes"]]),b(t(i))]),natureValue:s(({row:r})=>{var T;return[ue("div",null,P(((T=y.value.find($=>$.value===r.nature))==null?void 0:T.label)||r.nature),1)]}),_:1}),b(t(se),{ref_key:"uploadFormRef",ref:u,"biz-import-type":t(o),extension:t(C),"is-error":t(f),"upload-fn":t(f)?t(oe):t(te)},null,8,["biz-import-type","extension","is-error","upload-fn"])]),_:1})):(d(),g(t(Ce),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{He as default};
