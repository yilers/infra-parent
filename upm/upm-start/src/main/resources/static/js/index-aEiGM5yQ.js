var F=Object.defineProperty,R=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var x=(a,e,t)=>e in a?F(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,p=(a,e)=>{for(var t in e||(e={}))$.call(e,t)&&x(a,t,e[t]);if(T)for(var t of T(e))W.call(e,t)&&x(a,t,e[t]);return a},v=(a,e)=>R(a,V(e));var _=(a,e,t)=>new Promise((b,d)=>{var g=s=>{try{l(t.next(s))}catch(c){d(c)}},w=s=>{try{l(t.throw(s))}catch(c){d(c)}},l=s=>s.done?b(s.value):Promise.resolve(s.value).then(g,w);l((t=t.apply(a,e)).next())});import{W as Y}from"./index-C4NAiFfA.js";import{dI as j,dJ as q,dz as G,a7 as k}from"./bootstrap-DjYyHEgg.js";import{h as J}from"./fileTransfer-p8-3apt7.js";import{x as U}from"./table-FRaKquww.js";import{u as K,_ as Q}from"./useTableImport-CNd8lRg2.js";import{u as X}from"./useDownLoad-Cw45s4VH.js";import{u as Z}from"./useShopCheck-DKIjDUfz.js";import{ci as N,m as ee,b9 as te,aa as oe,be as ae,ab as f,b2 as m,bJ as n,j as h,u as o,bL as z,ai as E,ad as se,I as re,bb as ie,bp as ne}from"../jse/index-index-rmdNY63r.js";import{u as le}from"./useDateRangePicker-DjB1zMnJ.js";import{_ as ce}from"./page.vue_vue_type_script_setup_true_lang-CmAABu9Z.js";import{_ as pe}from"./fallback.vue_vue_type_script_setup_true_lang-CaaeY5iC.js";import"./index-ld-cT6bn.js";import"./hasIn-CXmLCMBI.js";import"./isSymbol-BoOBgcZb.js";import"./useRefs-ReJqRy3L.js";import"./dateTime-Ce6Ez397.js";import"./index-CovW7kLz.js";import"./rotate-cw-Dzdn7gja.js";const{dateRangePresets:me}=le(),I=[{label:"提现",value:"提现"},{label:"交易",value:"交易"},{label:"扣除交易手续费",value:"扣除交易手续费"}],O=[{label:"支出",value:"支出"},{label:"收入",value:"收入"}],S={toolbarConfig:{custom:!0,export:!1,refresh:!0,resizable:!0,zoom:!0,search:!1},columns:[{title:"序号",type:"seq",width:50},{field:"accountingTime",title:"记账时间",width:150},{field:"wechatPaymentOrderNo",title:"微信支付业务单号",width:280},{field:"fundFlowNo",title:"资金流水单号",width:280},{field:"businessName",title:"业务名称",width:150},{field:"businessType",title:"业务类型",width:150,formatter({cellValue:a}){const e=I.find(t=>t.value===a);return(e==null?void 0:e.label)||""}},{field:"incomeExpenseType",title:"收支类型",width:150,formatter({cellValue:a}){const e=O.find(t=>t.value===a);return(e==null?void 0:e.label)||""}},{field:"amount",title:"收支金额（元）",width:150},{field:"balance",title:"账户结余（元）",width:150},{field:"submitter",title:"资金变更提交申请人",width:150},{field:"remark",title:"备注",width:150},{field:"voucherNo",title:"业务凭证号",width:150}]},de={wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",compact:!0,collapsed:!0,commonConfig:{componentProps:{class:"w-full"}},schema:[me.datetime("accountingTime","记账时间",[N().startOf("month"),N().endOf("month")]),{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"wechatPaymentOrderNo",label:"业务单号"},{component:"Input",componentProps:{allowClear:!0},defaultValue:"",fieldName:"fundFlowNo",label:"流水单号"},{component:"Select",componentProps:{allowClear:!0,options:I,placeholder:"请选择"},fieldName:"businessType",label:"业务类型"},{component:"Select",componentProps:{allowClear:!0,options:O,placeholder:"请选择"},fieldName:"incomeExpenseType",label:"收支类型"}],fieldMappingTime:[["accountingTime",["startTime","endTime"],"YYYY-MM-DD HH:mm:ss"]],showCollapseButton:!0,submitOnChange:!1,submitOnEnter:!1},De=ee({__name:"index",setup(a){const{checkShopSelected:e}=Z(),{bizImportType:t,bizImportTypeList:b,uploadFormRef:d,extension:g,handleImport:w,ImportSettingButton:l}=K({importTypeList:[{id:1,label:"导入数据",bizCode:"WECHAT_MERCHANT_TRANSACTION",isError:!1,auth:"basic:weChatMerchantTransactionHistory:import"}],defaultExtension:".xlsx,.xls,.csv"}),s=te(j.wechatMerchantTransactionCsv),c=p({},de),P=v(p({},S),{toolbarConfig:p({},S.toolbarConfig),stripe:!0,border:!0,rowConfig:{isHover:!0},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(i,ue)=>_(null,[i,ue],function*({page:{currentPage:y,pageSize:r}},u){return e()?yield U(p({current:y,size:r},u)):{result:{records:[],total:0}}})}}}),D={},[L,C]=q({gridEvents:D,formOptions:c,gridOptions:P}),{handleDownload:M,downLoading:H}=X(),{hasAccessByCodes:A}=G(),B=oe(()=>A(["basic:weChatMerchantTransactionHistory:list"]));return(y,r)=>{const u=ae("access");return B.value?(m(),f(o(ce),{key:0,"auto-content-height":""},{default:n(()=>[h(o(L),null,{"toolbar-actions":n(()=>[(m(!0),se(re,null,ie(o(b),i=>z((m(),f(o(k),{key:i.id,type:"primary",style:{"margin-right":"12px"},onClick:ue=>o(w)(i.bizCode,i.isError,o(C))},{default:n(()=>[E(ne(i.label),1)]),_:2},1032,["onClick"])),[[u,[i.auth],"codes"]])),128))]),"toolbar-tools":n(()=>[z((m(),f(o(k),{loading:o(H),class:"mr-2",type:"primary",onClick:r[0]||(r[0]=i=>o(M)(o(C),s.value))},{icon:n(()=>[h(o(Y),{class:"mr-1 inline-block size-6"})]),default:n(()=>[r[1]||(r[1]=E(" 导出数据 ",-1))]),_:1},8,["loading"])),[[u,["basic:weChatMerchantTransactionHistory:export"],"codes"]]),h(o(l))]),_:1}),h(o(Q),{ref_key:"uploadFormRef",ref:d,"biz-import-type":o(t),"upload-fn":o(J),extension:o(g)},null,8,["biz-import-type","upload-fn","extension"])]),_:1})):(m(),f(o(pe),{key:1,description:"抱歉，您没有权限访问此页面。",status:"403"}))}}});export{De as default};
