var B=Object.defineProperty;var x=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var y=(c,t,e)=>t in c?B(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e,v=(c,t)=>{for(var e in t||(t={}))G.call(t,e)&&y(c,e,t[e]);if(x)for(var e of x(t))j.call(t,e)&&y(c,e,t[e]);return c};var l=(c,t,e)=>new Promise((k,h)=>{var g=r=>{try{u(e.next(r))}catch(d){h(d)}},a=r=>{try{u(e.throw(r))}catch(d){h(d)}},u=r=>r.done?k(r.value):Promise.resolve(r.value).then(g,a);u((e=e.apply(c,t)).next())});import{dX as A,bj as T,dJ as V,dY as O,dZ as q}from"./bootstrap-DjYyHEgg.js";import{h as z}from"./cardType-DPMG7IpI.js";import{u as E}from"./useSchemas-BvOAAoUm.js";import{m as J,b9 as w,n as R,ab as K,b2 as M,u as _,bJ as U,j as F}from"../jse/index-index-rmdNY63r.js";const D=J({__name:"choose-custom-modal",emits:["onSubmit"],setup(c,{expose:t,emit:e}){const k=e,{getChooseGridSchemas:h}=E(A.Sale),g=w(!1),a=w(),[u,r]=T({onOpenChange(o){return l(this,null,function*(){var n;const s=r.getData();g.value=(n=s==null?void 0:s.isUpdate)!=null?n:!1,a.value=o?s==null?void 0:s.defaultCheckedIds:[],o&&(yield R(),p.setGridOptions({checkboxConfig:{checkRowKeys:a.value}}))})},onConfirm(){return l(this,null,function*(){var s;const o=((s=a.value)==null?void 0:s.join(","))||"";k("onSubmit",o),r.close()})}}),d={columns:h(""),stripe:!0,border:!0,rowConfig:{isHover:!0,keyField:"id"},checkboxConfig:{reserve:!0,highlight:!0,checkRowKeys:a.value},columnConfig:{resizable:!1},showOverflow:!0,exportConfig:{},height:"auto",keepSource:!0,pagerConfig:{enabled:!0},proxyConfig:{ajax:{query:(m,C)=>l(null,[m,C],function*({page:{currentPage:o,pageSize:s}},n){const f=O.Custom;return yield z(v({current:o,size:s,type:q.Custom,businessCategory:"sale",businessType:f},n))})}}},P={checkboxChange(){a.value=b()},checkboxAll(){a.value=b()},pageChange({$grid:o}){R(()=>l(null,null,function*(){yield o.commitProxy("query"),o.getData().filter(m=>{var C;return(C=a.value)==null?void 0:C.includes(m.id)}).forEach(m=>{o.setCheckboxRow(m,!0)})}))}},[S,p]=V({gridOptions:d,gridEvents:P});function b(){var f;const o=p.grid.getCheckboxReserveRecords(),s=p.grid.getCheckboxRecords(),n=p.grid.getData(),C=[...((f=a.value)==null?void 0:f.filter(i=>!n.some(I=>I.id===i)))||[],...o.map(i=>i.id),...s.map(i=>i.id)];return[...new Set(C)]}return t(r),(o,s)=>(M(),K(_(u),{title:(g.value,"选择"),class:"h-[80%] w-[50%]","content-class":"h-[100%]"},{default:U(()=>[F(_(S))]),_:1},8,["title"]))}});export{D as _};
